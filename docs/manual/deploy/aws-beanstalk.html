<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
<title>AWS - Elastic Beanstalk · Otoroshi</title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content='otoroshi-manual'/>
<link href="https://fonts.googleapis.com/css?family=Roboto:100normal,100italic,300normal,300italic,400normal,400italic,500normal,500italic,700normal,700italic,900normal,900italicc" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../js/page.js"></script>
<script type="text/javascript" src="../js/cc.js"></script>
<script type="text/javascript" src="../js/groups.js"></script>
<link rel="stylesheet" type="text/css" href="../lib/normalize.css/normalize.css"/>
<link rel="stylesheet" type="text/css" href="../lib/foundation/dist/foundation.min.css"/>
<link rel="stylesheet" type="text/css" href="../css/page.css"/>

<!--
<link rel="shortcut icon" href="../images/favicon.ico" />
-->
</head>

<body>
<div class="off-canvas-wrapper">
<div class="off-canvas-wrapper-inner" data-off-canvas-wrapper>

<div class="off-canvas position-left" id="off-canvas-menu" data-off-canvas>
<nav class="off-canvas-nav">
<div class="nav-home">
<a href="../index.html" >
<span class="home-icon">⌂</span>Otoroshi
</a>
<div class="version-number">
1.5.0-rc.2
</div>
</div>
<div class="nav-toc">
<ul>
  <li><a href="../about.html" class="page">About Otoroshi</a></li>
  <li><a href="../archi.html" class="page">Architecture</a></li>
  <li><a href="../features.html" class="page">Features</a></li>
  <li><a href="../quickstart.html" class="page">Try Otoroshi in 5 minutes</a></li>
  <li><a href="../getotoroshi/index.html" class="page">Get Otoroshi</a>
  <ul>
    <li><a href="../getotoroshi/fromsources.html" class="page">From sources</a></li>
    <li><a href="../getotoroshi/frombinaries.html" class="page">From binaries</a></li>
    <li><a href="../getotoroshi/fromdocker.html" class="page">From docker</a></li>
  </ul></li>
  <li><a href="../firstrun/index.html" class="page">First run</a>
  <ul>
    <li><a href="../firstrun/datastore.html" class="page">Choose your datastore</a></li>
    <li><a href="../firstrun/configfile.html" class="page">Config. with files</a></li>
    <li><a href="../firstrun/env.html" class="page">Config. with ENVs</a></li>
    <li><a href="../firstrun/initialstate.html" class="page">Import initial state</a></li>
    <li><a href="../firstrun/host.html" class="page">Setup your hosts</a></li>
    <li><a href="../firstrun/run.html" class="page">Run Otoroshi</a></li>
  </ul></li>
  <li><a href="../setup/index.html" class="page">Setup Otoroshi</a>
  <ul>
    <li><a href="../setup/admin.html" class="page">Manage admin users</a></li>
    <li><a href="../setup/dangerzone.html" class="page">Configure the Danger zone</a></li>
  </ul></li>
  <li><a href="../usage/index.html" class="page">Using Otoroshi</a>
  <ul>
    <li><a href="../usage/1-groups.html" class="page">Managing service groups</a></li>
    <li><a href="../usage/2-services.html" class="page">Managing services</a></li>
    <li><a href="../usage/3-apikeys.html" class="page">Managing API keys</a></li>
    <li><a href="../usage/4-monitor.html" class="page">Monitoring services</a></li>
    <li><a href="../usage/5-sessions.html" class="page">Managing sessions</a></li>
    <li><a href="../usage/6-audit.html" class="page">Auditing Otoroshi</a></li>
    <li><a href="../usage/7-metrics.html" class="page">Otoroshi global metrics</a></li>
    <li><a href="../usage/8-importsexports.html" class="page">Import and export</a></li>
    <li><a href="../usage/9-auth.html" class="page">Authentication</a></li>
  </ul></li>
  <li><a href="../integrations/index.html" class="page">Third party Integrations</a>
  <ul>
    <li><a href="../integrations/analytics.html" class="page">Analytics</a></li>
    <li><a href="../integrations/mailgun.html" class="page">Mailgun</a></li>
    <li><a href="../integrations/statsd.html" class="page">StatsD / Datadog</a></li>
    <li><a href="../integrations/clevercloud.html" class="page">Clever Cloud</a></li>
  </ul></li>
  <li><a href="../topics/index.html" class="page">Detailed topics</a>
  <ul>
    <li><a href="../topics/snow-monkey.html" class="page">Chaos engineering with the Snow Monkey</a></li>
    <li><a href="../topics/jwt-verifications.html" class="page">JWT Tokens verification</a></li>
    <li><a href="../topics/ssl.html" class="page">SSL/TLS termination with Otoroshi</a></li>
    <li><a href="../topics/mtls.html" class="page">Mutual TLS with Otoroshi</a></li>
    <li><a href="../topics/clustering.html" class="page">Otoroshi clustering</a></li>
    <li><a href="../topics/plugins.html" class="page">Otoroshi plugins</a></li>
    <li><a href="../topics/monitoring.html" class="page">Monitoring Otoroshi</a></li>
  </ul></li>
  <li><a href="../api.html" class="page">Admin REST API</a></li>
  <li><a href="../deploy/index.html" class="page">Deploy to production</a>
  <ul>
    <li><a href="../deploy/kubernetes.html" class="page">Kubernetes</a></li>
    <li><a href="../deploy/clevercloud.html" class="page">Clever Cloud</a></li>
    <li><a href="../deploy/aws-beanstalk.html" class="active page">AWS - Elastic Beanstalk</a></li>
    <li><a href="../deploy/other.html" class="page">Others</a></li>
    <li><a href="../deploy/scaling.html" class="page">Scaling Otoroshi</a></li>
  </ul></li>
  <li><a href="../dev.html" class="page">Developing Otoroshi</a></li>
  <li><a href="../plugins/index.html" class="page">Otoroshi plugins</a>
  <ul>
    <li><a href="../plugins/otoroshi-plugins-accesslog-accesslog.html" class="page">Access log (CLF)</a></li>
    <li><a href="../plugins/otoroshi-plugins-accesslog-accesslogjson.html" class="page">Access log (JSON)</a></li>
    <li><a href="../plugins/otoroshi-plugins-users-hasallowedusersvalidator.html" class="page">Allowed users only</a></li>
    <li><a href="../plugins/otoroshi-plugins-apikeys-apikeyauthmodule.html" class="page">Apikey auth module</a></li>
    <li><a href="../plugins/otoroshi-plugins-biscuit-biscuitextractor.html" class="page">Apikey from Biscuit token extractor</a></li>
    <li><a href="../plugins/otoroshi-plugins-authcallers-basicauthcaller.html" class="page">Basic Auth. caller</a></li>
    <li><a href="../plugins/otoroshi-plugins-biscuit-biscuitvalidator.html" class="page">Biscuit token validator</a></li>
    <li><a href="../plugins/otoroshi-plugins-loggers-bodylogger.html" class="page">Body logger</a></li>
    <li><a href="../plugins/otoroshi-plugins-clientcert-hasclientcertmatchingapikeyvalidator.html" class="page">Client Certificate + Api Key only</a></li>
    <li><a href="../plugins/otoroshi-plugins-clientcert-hasclientcertvalidator.html" class="page">Client Certificate Only</a></li>
    <li><a href="../plugins/otoroshi-plugins-apikeys-clientcredentialflowextractor.html" class="page">Client Credential Flow ApiKey extractor</a></li>
    <li><a href="../plugins/otoroshi-plugins-apikeys-clientcredentialservice.html" class="page">Client Credential Service</a></li>
    <li><a href="../plugins/otoroshi-plugins-apikeys-certificateasapikey.html" class="page">Client certificate as apikey</a></li>
    <li><a href="../plugins/otoroshi-plugins-clientcert-clientcertchainheader.html" class="page">Client certificate header</a></li>
    <li><a href="../plugins/otoroshi-plugins-clientcert-hasclientcertmatchingvalidator.html" class="page">Client certificate matching</a></li>
    <li><a href="../plugins/otoroshi-plugins-clientcert-hasclientcertmatchinghttpvalidator.html" class="page">Client certificate matching (over http)</a></li>
    <li><a href="../plugins/otoroshi-plugins-defer-deferplugin.html" class="page">Defer Responses</a></li>
    <li><a href="../plugins/otoroshi-plugins-envoy-envoycontrolplane.html" class="page">Envoy Control Plane (experimental)</a></li>
    <li><a href="../plugins/otoroshi-plugins-external-externalhttpvalidator.html" class="page">External Http Validator</a></li>
    <li><a href="../plugins/otoroshi-plugins-geoloc-ipstackgeolocationinfoextractor.html" class="page">Geolocation details extractor (using IpStack api)</a></li>
    <li><a href="../plugins/otoroshi-plugins-geoloc-maxmindgeolocationinfoextractor.html" class="page">Geolocation details extractor (using Maxmind db)</a></li>
    <li><a href="../plugins/otoroshi-plugins-geoloc-geolocationinfoendpoint.html" class="page">Geolocation endpoint</a></li>
    <li><a href="../plugins/otoroshi-plugins-geoloc-geolocationinfoheader.html" class="page">Geolocation header</a></li>
    <li><a href="../plugins/otoroshi-plugins-discovery-discoveryselfregistrationsink.html" class="page">Global self registration endpoints (service discovery)</a></li>
    <li><a href="../plugins/otoroshi-plugins-hmac-hmacvalidator.html" class="page">HMAC access validator</a></li>
    <li><a href="../plugins/otoroshi-plugins-hmac-hmaccallerplugin.html" class="page">HMAC caller plugin</a></li>
    <li><a href="../plugins/otoroshi-plugins-jsoup-htmlpatcher.html" class="page">Html Patcher</a></li>
    <li><a href="../plugins/otoroshi-plugins-quotas-instancequotas.html" class="page">Instance quotas</a></li>
    <li><a href="../plugins/otoroshi-plugins-izanami-izanamiproxy.html" class="page">Izanami APIs Proxy</a></li>
    <li><a href="../plugins/otoroshi-plugins-izanami-izanamicanary.html" class="page">Izanami Canary Campaign</a></li>
    <li><a href="../plugins/otoroshi-plugins-jwt-jwtuserextractor.html" class="page">Jwt user extractor</a></li>
    <li><a href="../plugins/otoroshi-plugins-accesslog-kafkaaccesslog.html" class="page">Kafka access log</a></li>
    <li><a href="../plugins/otoroshi-plugins-jobs-kubernetes-kubernetesingresscontrollerjob.html" class="page">Kubernetes Ingress Controller</a></li>
    <li><a href="../plugins/otoroshi-plugins-jobs-kubernetes-kubernetesotoroshicrdscontrollerjob.html" class="page">Kubernetes Otoroshi CRDs Controller</a></li>
    <li><a href="../plugins/otoroshi-plugins-jobs-kubernetes-kubernetesadmissionwebhookcrdvalidator.html" class="page">Kubernetes admission validator webhook</a></li>
    <li><a href="../plugins/otoroshi-plugins-jobs-kubernetes-kubernetesadmissionwebhooksidecarinjector.html" class="page">Kubernetes sidecar injector webhook</a></li>
    <li><a href="../plugins/otoroshi-plugins-jobs-kubernetes-kubernetestootoroshicertsyncjob.html" class="page">Kubernetes to Otoroshi certs. synchronizer</a></li>
    <li><a href="../plugins/otoroshi-plugins-mirror-mirroringplugin.html" class="page">Mirroring plugin</a></li>
    <li><a href="../plugins/otoroshi-plugins-oauth1-oauth1callerplugin.html" class="page">OAuth1 caller</a></li>
    <li><a href="../plugins/otoroshi-plugins-authcallers-oauth2caller.html" class="page">OAuth2 caller</a></li>
    <li><a href="../plugins/otoroshi-plugins-oidc-oidcaccesstokenasapikey.html" class="page">OIDC access_token as apikey</a></li>
    <li><a href="../plugins/otoroshi-plugins-oidc-oidcaccesstokenvalidator.html" class="page">OIDC access_token validator</a></li>
    <li><a href="../plugins/otoroshi-plugins-oidc-oidcheaders.html" class="page">OIDC headers</a></li>
    <li><a href="../plugins/otoroshi-plugins-jobs-kubernetes-otoroshitokubernetescertsyncjob.html" class="page">Otoroshi certs. to Kubernetes secrets synchronizer</a></li>
    <li><a href="../plugins/otoroshi-plugins-metrics-prometheusendpoint.html" class="page">Prometheus Endpoint</a></li>
    <li><a href="../plugins/otoroshi-plugins-metrics-prometheusservicemetrics.html" class="page">Prometheus Service Metrics</a></li>
    <li><a href="../plugins/otoroshi-plugins-quotas-servicequotas.html" class="page">Public quotas</a></li>
    <li><a href="../plugins/otoroshi-plugins-cache-responsecache.html" class="page">Response Cache</a></li>
    <li><a href="../plugins/otoroshi-plugins-security-securitytxt.html" class="page">Security Txt</a></li>
    <li><a href="../plugins/otoroshi-plugins-discovery-discoveryselfregistrationtransformer.html" class="page">Self registration endpoints (service discovery)</a></li>
    <li><a href="../plugins/otoroshi-plugins-metrics-servicemetrics.html" class="page">Service Metrics</a></li>
    <li><a href="../plugins/otoroshi-plugins-discovery-discoverytargetsselector.html" class="page">Service discovery target selector (service discovery)</a></li>
    <li><a href="../plugins/otoroshi-plugins-static-staticresponse.html" class="page">Static Response</a></li>
    <li><a href="../plugins/otoroshi-plugins-useragent-useragentextractor.html" class="page">User-Agent details extractor</a></li>
    <li><a href="../plugins/otoroshi-plugins-useragent-useragentinfoendpoint.html" class="page">User-Agent endpoint</a></li>
    <li><a href="../plugins/otoroshi-plugins-useragent-useragentinfoheader.html" class="page">User-Agent header</a></li>
    <li><a href="../plugins/otoroshi-plugins-workflow-workflowendpoint.html" class="page">Workflow endpoint</a></li>
    <li><a href="../plugins/otoroshi-plugins-workflow-workflowjob.html" class="page">Workflow job</a></li>
  </ul></li>
</ul>
</div>

</nav>
</div>

<div class="off-canvas-content" data-off-canvas-content>

<header class="site-header expanded row">
<div class="small-12 column">
<a href="#" class="off-canvas-toggle hide-for-medium" data-toggle="off-canvas-menu"><svg class="svg-icon svg-icon-menu" version="1.1" id="Menu" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve"> <path class="svg-icon-menu-path" fill="#53CDEC" d="M16.4,9H3.6C3.048,9,3,9.447,3,10c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,9.447,16.952,9,16.4,9z M16.4,13
H3.6C3.048,13,3,13.447,3,14c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,13.447,16.952,13,16.4,13z M3.6,7H16.4
C16.952,7,17,6.553,17,6c0-0.553-0.048-1-0.6-1H3.6C3.048,5,3,5.447,3,6C3,6.553,3.048,7,3.6,7z"/></svg>
</a>
<div class="title-wrapper">
<div class="title-logo"></div>
<div class="title"><a href="../index.html">Otoroshi</a></div>
</div>
<!--
<a href="https://www.example.com" class="logo show-for-medium">logo</a>
-->
</div>
</header>

<div class="expanded row">

<div class="medium-3 large-2 show-for-medium column">
<nav class="site-nav">
<div class="nav-home">
<a href="../index.html" >
<span class="home-icon">⌂</span>Otoroshi
</a>
<div class="version-number">
1.5.0-rc.2
</div>
</div>
<div class="nav-toc">
<ul>
  <li><a href="../about.html" class="page">About Otoroshi</a></li>
  <li><a href="../archi.html" class="page">Architecture</a></li>
  <li><a href="../features.html" class="page">Features</a></li>
  <li><a href="../quickstart.html" class="page">Try Otoroshi in 5 minutes</a></li>
  <li><a href="../getotoroshi/index.html" class="page">Get Otoroshi</a>
  <ul>
    <li><a href="../getotoroshi/fromsources.html" class="page">From sources</a></li>
    <li><a href="../getotoroshi/frombinaries.html" class="page">From binaries</a></li>
    <li><a href="../getotoroshi/fromdocker.html" class="page">From docker</a></li>
  </ul></li>
  <li><a href="../firstrun/index.html" class="page">First run</a>
  <ul>
    <li><a href="../firstrun/datastore.html" class="page">Choose your datastore</a></li>
    <li><a href="../firstrun/configfile.html" class="page">Config. with files</a></li>
    <li><a href="../firstrun/env.html" class="page">Config. with ENVs</a></li>
    <li><a href="../firstrun/initialstate.html" class="page">Import initial state</a></li>
    <li><a href="../firstrun/host.html" class="page">Setup your hosts</a></li>
    <li><a href="../firstrun/run.html" class="page">Run Otoroshi</a></li>
  </ul></li>
  <li><a href="../setup/index.html" class="page">Setup Otoroshi</a>
  <ul>
    <li><a href="../setup/admin.html" class="page">Manage admin users</a></li>
    <li><a href="../setup/dangerzone.html" class="page">Configure the Danger zone</a></li>
  </ul></li>
  <li><a href="../usage/index.html" class="page">Using Otoroshi</a>
  <ul>
    <li><a href="../usage/1-groups.html" class="page">Managing service groups</a></li>
    <li><a href="../usage/2-services.html" class="page">Managing services</a></li>
    <li><a href="../usage/3-apikeys.html" class="page">Managing API keys</a></li>
    <li><a href="../usage/4-monitor.html" class="page">Monitoring services</a></li>
    <li><a href="../usage/5-sessions.html" class="page">Managing sessions</a></li>
    <li><a href="../usage/6-audit.html" class="page">Auditing Otoroshi</a></li>
    <li><a href="../usage/7-metrics.html" class="page">Otoroshi global metrics</a></li>
    <li><a href="../usage/8-importsexports.html" class="page">Import and export</a></li>
    <li><a href="../usage/9-auth.html" class="page">Authentication</a></li>
  </ul></li>
  <li><a href="../integrations/index.html" class="page">Third party Integrations</a>
  <ul>
    <li><a href="../integrations/analytics.html" class="page">Analytics</a></li>
    <li><a href="../integrations/mailgun.html" class="page">Mailgun</a></li>
    <li><a href="../integrations/statsd.html" class="page">StatsD / Datadog</a></li>
    <li><a href="../integrations/clevercloud.html" class="page">Clever Cloud</a></li>
  </ul></li>
  <li><a href="../topics/index.html" class="page">Detailed topics</a>
  <ul>
    <li><a href="../topics/snow-monkey.html" class="page">Chaos engineering with the Snow Monkey</a></li>
    <li><a href="../topics/jwt-verifications.html" class="page">JWT Tokens verification</a></li>
    <li><a href="../topics/ssl.html" class="page">SSL/TLS termination with Otoroshi</a></li>
    <li><a href="../topics/mtls.html" class="page">Mutual TLS with Otoroshi</a></li>
    <li><a href="../topics/clustering.html" class="page">Otoroshi clustering</a></li>
    <li><a href="../topics/plugins.html" class="page">Otoroshi plugins</a></li>
    <li><a href="../topics/monitoring.html" class="page">Monitoring Otoroshi</a></li>
  </ul></li>
  <li><a href="../api.html" class="page">Admin REST API</a></li>
  <li><a href="../deploy/index.html" class="page">Deploy to production</a>
  <ul>
    <li><a href="../deploy/kubernetes.html" class="page">Kubernetes</a></li>
    <li><a href="../deploy/clevercloud.html" class="page">Clever Cloud</a></li>
    <li><a href="../deploy/aws-beanstalk.html" class="active page">AWS - Elastic Beanstalk</a></li>
    <li><a href="../deploy/other.html" class="page">Others</a></li>
    <li><a href="../deploy/scaling.html" class="page">Scaling Otoroshi</a></li>
  </ul></li>
  <li><a href="../dev.html" class="page">Developing Otoroshi</a></li>
  <li><a href="../plugins/index.html" class="page">Otoroshi plugins</a>
  <ul>
    <li><a href="../plugins/otoroshi-plugins-accesslog-accesslog.html" class="page">Access log (CLF)</a></li>
    <li><a href="../plugins/otoroshi-plugins-accesslog-accesslogjson.html" class="page">Access log (JSON)</a></li>
    <li><a href="../plugins/otoroshi-plugins-users-hasallowedusersvalidator.html" class="page">Allowed users only</a></li>
    <li><a href="../plugins/otoroshi-plugins-apikeys-apikeyauthmodule.html" class="page">Apikey auth module</a></li>
    <li><a href="../plugins/otoroshi-plugins-biscuit-biscuitextractor.html" class="page">Apikey from Biscuit token extractor</a></li>
    <li><a href="../plugins/otoroshi-plugins-authcallers-basicauthcaller.html" class="page">Basic Auth. caller</a></li>
    <li><a href="../plugins/otoroshi-plugins-biscuit-biscuitvalidator.html" class="page">Biscuit token validator</a></li>
    <li><a href="../plugins/otoroshi-plugins-loggers-bodylogger.html" class="page">Body logger</a></li>
    <li><a href="../plugins/otoroshi-plugins-clientcert-hasclientcertmatchingapikeyvalidator.html" class="page">Client Certificate + Api Key only</a></li>
    <li><a href="../plugins/otoroshi-plugins-clientcert-hasclientcertvalidator.html" class="page">Client Certificate Only</a></li>
    <li><a href="../plugins/otoroshi-plugins-apikeys-clientcredentialflowextractor.html" class="page">Client Credential Flow ApiKey extractor</a></li>
    <li><a href="../plugins/otoroshi-plugins-apikeys-clientcredentialservice.html" class="page">Client Credential Service</a></li>
    <li><a href="../plugins/otoroshi-plugins-apikeys-certificateasapikey.html" class="page">Client certificate as apikey</a></li>
    <li><a href="../plugins/otoroshi-plugins-clientcert-clientcertchainheader.html" class="page">Client certificate header</a></li>
    <li><a href="../plugins/otoroshi-plugins-clientcert-hasclientcertmatchingvalidator.html" class="page">Client certificate matching</a></li>
    <li><a href="../plugins/otoroshi-plugins-clientcert-hasclientcertmatchinghttpvalidator.html" class="page">Client certificate matching (over http)</a></li>
    <li><a href="../plugins/otoroshi-plugins-defer-deferplugin.html" class="page">Defer Responses</a></li>
    <li><a href="../plugins/otoroshi-plugins-envoy-envoycontrolplane.html" class="page">Envoy Control Plane (experimental)</a></li>
    <li><a href="../plugins/otoroshi-plugins-external-externalhttpvalidator.html" class="page">External Http Validator</a></li>
    <li><a href="../plugins/otoroshi-plugins-geoloc-ipstackgeolocationinfoextractor.html" class="page">Geolocation details extractor (using IpStack api)</a></li>
    <li><a href="../plugins/otoroshi-plugins-geoloc-maxmindgeolocationinfoextractor.html" class="page">Geolocation details extractor (using Maxmind db)</a></li>
    <li><a href="../plugins/otoroshi-plugins-geoloc-geolocationinfoendpoint.html" class="page">Geolocation endpoint</a></li>
    <li><a href="../plugins/otoroshi-plugins-geoloc-geolocationinfoheader.html" class="page">Geolocation header</a></li>
    <li><a href="../plugins/otoroshi-plugins-discovery-discoveryselfregistrationsink.html" class="page">Global self registration endpoints (service discovery)</a></li>
    <li><a href="../plugins/otoroshi-plugins-hmac-hmacvalidator.html" class="page">HMAC access validator</a></li>
    <li><a href="../plugins/otoroshi-plugins-hmac-hmaccallerplugin.html" class="page">HMAC caller plugin</a></li>
    <li><a href="../plugins/otoroshi-plugins-jsoup-htmlpatcher.html" class="page">Html Patcher</a></li>
    <li><a href="../plugins/otoroshi-plugins-quotas-instancequotas.html" class="page">Instance quotas</a></li>
    <li><a href="../plugins/otoroshi-plugins-izanami-izanamiproxy.html" class="page">Izanami APIs Proxy</a></li>
    <li><a href="../plugins/otoroshi-plugins-izanami-izanamicanary.html" class="page">Izanami Canary Campaign</a></li>
    <li><a href="../plugins/otoroshi-plugins-jwt-jwtuserextractor.html" class="page">Jwt user extractor</a></li>
    <li><a href="../plugins/otoroshi-plugins-accesslog-kafkaaccesslog.html" class="page">Kafka access log</a></li>
    <li><a href="../plugins/otoroshi-plugins-jobs-kubernetes-kubernetesingresscontrollerjob.html" class="page">Kubernetes Ingress Controller</a></li>
    <li><a href="../plugins/otoroshi-plugins-jobs-kubernetes-kubernetesotoroshicrdscontrollerjob.html" class="page">Kubernetes Otoroshi CRDs Controller</a></li>
    <li><a href="../plugins/otoroshi-plugins-jobs-kubernetes-kubernetesadmissionwebhookcrdvalidator.html" class="page">Kubernetes admission validator webhook</a></li>
    <li><a href="../plugins/otoroshi-plugins-jobs-kubernetes-kubernetesadmissionwebhooksidecarinjector.html" class="page">Kubernetes sidecar injector webhook</a></li>
    <li><a href="../plugins/otoroshi-plugins-jobs-kubernetes-kubernetestootoroshicertsyncjob.html" class="page">Kubernetes to Otoroshi certs. synchronizer</a></li>
    <li><a href="../plugins/otoroshi-plugins-mirror-mirroringplugin.html" class="page">Mirroring plugin</a></li>
    <li><a href="../plugins/otoroshi-plugins-oauth1-oauth1callerplugin.html" class="page">OAuth1 caller</a></li>
    <li><a href="../plugins/otoroshi-plugins-authcallers-oauth2caller.html" class="page">OAuth2 caller</a></li>
    <li><a href="../plugins/otoroshi-plugins-oidc-oidcaccesstokenasapikey.html" class="page">OIDC access_token as apikey</a></li>
    <li><a href="../plugins/otoroshi-plugins-oidc-oidcaccesstokenvalidator.html" class="page">OIDC access_token validator</a></li>
    <li><a href="../plugins/otoroshi-plugins-oidc-oidcheaders.html" class="page">OIDC headers</a></li>
    <li><a href="../plugins/otoroshi-plugins-jobs-kubernetes-otoroshitokubernetescertsyncjob.html" class="page">Otoroshi certs. to Kubernetes secrets synchronizer</a></li>
    <li><a href="../plugins/otoroshi-plugins-metrics-prometheusendpoint.html" class="page">Prometheus Endpoint</a></li>
    <li><a href="../plugins/otoroshi-plugins-metrics-prometheusservicemetrics.html" class="page">Prometheus Service Metrics</a></li>
    <li><a href="../plugins/otoroshi-plugins-quotas-servicequotas.html" class="page">Public quotas</a></li>
    <li><a href="../plugins/otoroshi-plugins-cache-responsecache.html" class="page">Response Cache</a></li>
    <li><a href="../plugins/otoroshi-plugins-security-securitytxt.html" class="page">Security Txt</a></li>
    <li><a href="../plugins/otoroshi-plugins-discovery-discoveryselfregistrationtransformer.html" class="page">Self registration endpoints (service discovery)</a></li>
    <li><a href="../plugins/otoroshi-plugins-metrics-servicemetrics.html" class="page">Service Metrics</a></li>
    <li><a href="../plugins/otoroshi-plugins-discovery-discoverytargetsselector.html" class="page">Service discovery target selector (service discovery)</a></li>
    <li><a href="../plugins/otoroshi-plugins-static-staticresponse.html" class="page">Static Response</a></li>
    <li><a href="../plugins/otoroshi-plugins-useragent-useragentextractor.html" class="page">User-Agent details extractor</a></li>
    <li><a href="../plugins/otoroshi-plugins-useragent-useragentinfoendpoint.html" class="page">User-Agent endpoint</a></li>
    <li><a href="../plugins/otoroshi-plugins-useragent-useragentinfoheader.html" class="page">User-Agent header</a></li>
    <li><a href="../plugins/otoroshi-plugins-workflow-workflowendpoint.html" class="page">Workflow endpoint</a></li>
    <li><a href="../plugins/otoroshi-plugins-workflow-workflowjob.html" class="page">Workflow job</a></li>
  </ul></li>
</ul>
</div>

</nav>
</div>

<div class="small-12 medium-9 large-10 column">
<section class="site-content">

<div class="page-header row">
<div class="medium-12 show-for-medium column">
<div class="nav-breadcrumbs">
<ul>
  <li><a href="../index.html">Otoroshi</a></li>
  <li><a href="../deploy/index.html">Deploy to production</a></li>
  <li>AWS - Elastic Beanstalk</li>
</ul>
</div>
</div>
</div>

<div class="page-content row">
<div class="small-12 large-9 column" id="docs">
<h1><a href="#aws-elastic-beanstalk" name="aws-elastic-beanstalk" class="anchor"><span class="anchor-link"></span></a>AWS - Elastic Beanstalk</h1>
<p>Now you want to use Otoroshi on AWS. There are multiple options to deploy Otoroshi on AWS, for instance :</p>
<ul>
  <li>You can deploy the <a href="../getotoroshi/fromdocker.html">Docker image</a> on <a href="https://docs.aws.amazon.com/AmazonECS/latest/developerguide/docker-basics.html">Amazon ECS</a></li>
  <li>You can create a basic <a href="https://docs.aws.amazon.com/fr_fr/AWSEC2/latest/UserGuide/concepts.html">Amazon EC2</a>, access it via SSH, then deploy the <a href="../firstrun/run.html#from-jar-file">otoroshi.jar</a></li>
  <li>Or you can use <a href="https://aws.amazon.com/fr/elasticbeanstalk">AWS Elastic Beanstalk</a></li>
</ul>
<p>In this section we are going to cover how to deploy Otoroshi on <a href="https://aws.amazon.com/fr/elasticbeanstalk">AWS Elastic Beanstalk</a>. </p>
<h2><a href="#aws-elastic-beanstalk-overview" name="aws-elastic-beanstalk-overview" class="anchor"><span class="anchor-link"></span></a>AWS Elastic Beanstalk Overview</h2>
<p>Unlike Clever Cloud, to deploy an application on AWS Elastic Beanstalk, you don&rsquo;t link your app to your VCS repository, push your code and expect it to be built and run.</p>
<p>AWS Elastic Beanstalk does only the run part. So you have to handle your own build pipeline, upload a Zip file containing your runnable, then AWS Elastic Beanstalk will take it from there. </p>
<p>Eg: for apps running on the JVM (Scala/Java/Kotlin) a Zip with the jar inside would suffice, for apps running in a Docker container, a Zip with the DockerFile would be enough. </p>
<h2><a href="#prepare-your-deployment-target" name="prepare-your-deployment-target" class="anchor"><span class="anchor-link"></span></a>Prepare your deployment target</h2>
<p>Actually, there are 2 options to build your target. </p>
<p>Either you create a DockerFile from this <a href="../getotoroshi/fromdocker.html">Docker image</a>, build a zip, and do all the Otoroshi custom configuration using ENVs.</p>
<p>Or you download the <a href="../getotoroshi/frombinaries.html">otoroshi.jar</a>, do all the Otoroshi custom configuration using your own otoroshi.conf, and create a DockerFile that runs the jar using your otoroshi.conf. </p>
<p>For the second option your DockerFile would look like this :</p>
<pre class="prettyprint"><code class="language-dockerfile">FROM openjdk:8
VOLUME /tmp
EXPOSE 8080
ADD otoroshi.jar otoroshi.jar
ADD otoroshi.conf otoroshi.conf
RUN sh -c &#39;touch /otoroshi.jar&#39;
ENV JAVA_OPTS=&quot;&quot;
ENTRYPOINT [ &quot;sh&quot;, &quot;-c&quot;, &quot;java $JAVA_OPTS -Djava.security.egd=file:/dev/./urandom -Dconfig.file=/otoroshi.conf -jar /otoroshi.jar&quot; ]
</code></pre>
<p>I&rsquo;d recommend the second option.</p>
<p>Now Zip your target (Jar + Conf + DockerFile) and get ready for deployment. </p>
<h2><a href="#create-an-otoroshi-instance-on-aws-elastic-beanstalk" name="create-an-otoroshi-instance-on-aws-elastic-beanstalk" class="anchor"><span class="anchor-link"></span></a>Create an Otoroshi instance on AWS Elastic Beanstalk</h2>
<p>First, go to <a href="https://eu-west-3.console.aws.amazon.com/elasticbeanstalk/home?region=eu-west-3#/welcome">AWS Elastic Beanstalk Console</a>, don&rsquo;t forget to sign in and make sure that you are in the good region (eg : eu-west-3 for Paris).</p>
<p>Hit <strong>Get started</strong> </p><div class="centered-img">
<img src="../img/deploy-elb-0.png" /></div>
<p>Specify the <strong>Application name</strong> of your application, Otoroshi for example.</p><div class="centered-img">
<img src="../img/deploy-elb-1.png" /></div>
<p>Choose the <strong>Platform</strong> of the application you want to create, in your case use Docker.</p>
<p>For <strong>Application code</strong> choose <strong>Upload your code</strong> then hit <strong>Upload</strong>.</p><div class="centered-img">
<img src="../img/deploy-elb-2.png" /></div>
<p>Browse the zip created in the <a href="#prepare-your-deployment-target">previous section</a> from your machine. </p>
<p>As you can see in the image above, you can also choose an S3 location, you can imagine that at the end of your build pipeline you upload your Zip to S3, and then get it from there (I wouldn&rsquo;t recommend that though).</p>
<p>When the upload is done, hit <strong>Configure more options</strong>.</p><div class="centered-img">
<img src="../img/deploy-elb-3.png" /></div>
<p>Right now an AWS Elastic Beanstalk application has been created, and by default an environment named Otoroshi-env is being created as well.</p>
<p>AWS Elastic Beanstalk can manage multiple environments of the same application, for instance environments can be (prod, preprod, expriments&hellip;). </p>
<p>Otoroshi is a bit particular, it doesn&rsquo;t make much sense to have multiple environments, since Otoroshi will handle all the requests from/to downstream services regardless of the environment. </p>
<p>As you see in the image above, we are now configuring the Otoroshi-env, the one and only environment of Otoroshi.</p>
<p>For <strong>Configuration presets</strong>, choose custom configuration, now you have a load balancer for your environment with the capacity of at least one instance and at most four. I&rsquo;d recommend at least 2 instances, to change that, on the <strong>Capacity</strong> card hit <strong>Modify</strong>. </p><div class="centered-img">
<img src="../img/deploy-elb-4.png" /></div>
<p>Change the <strong>Instances</strong> to min 2, max 4 then hit <strong>Save</strong>. For the <strong>Scaling triggers</strong>, I&rsquo;d keep the default values, but know that you can edit the capacity config any time you want, it only costs a redeploy, which will be done automatically by the way.</p>
<p>Instances size is by default t2.micro, which is a bit small for running Otoroshi, I&rsquo;d recommend a t2.medium.<br/>On the <strong>Instances</strong> card hit <strong>Modify</strong>.</p><div class="centered-img">
<img src="../img/deploy-elb-5.png" /></div>
<p>For <strong>Instance type</strong> choose t2.medium, then hit <strong>Save</strong>, no need to change the volume size, unless you have a lot of http call faults, which means a lot more logs, in that case the default volume size may not be enough.</p>
<p>The default environment created for Otoroshi, for instance Otoroshi-env, is a web server environment which fits in your case, but the thing is that on AWS Elastic Beanstalk by default a web server environment for a docker-based application, runs behind an Nginx proxy. We have to remove that proxy. So on the <strong>Software</strong> card hit <strong>Modify</strong>.</p><div class="centered-img">
<img src="../img/deploy-elb-6.png" /></div>
<p>For <strong>Proxy server</strong> choose None then hit <strong>Save</strong>.</p>
<p>Also note that you can set Envs for Otoroshi in same page (see image below). </p><div class="centered-img">
<img src="../img/deploy-elb-7.png" /></div>
<p>To finalise the creation process, hit <strong>Create app</strong> on the bottom right.</p>
<p>The Otoroshi app is now created, and it&rsquo;s running which is cool, but we still don&rsquo;t have neither a <strong>datastore</strong> nor <strong>https</strong>.</p>
<h2><a href="#create-an-otoroshi-datastore-on-aws-elasticache" name="create-an-otoroshi-datastore-on-aws-elasticache" class="anchor"><span class="anchor-link"></span></a>Create an Otoroshi datastore on AWS ElastiCache</h2>
<p>By default Otoroshi uses non persistent memory to store it&rsquo;s data, Otoroshi supports many kinds of datastores. In this section we will be covering Redis datastore. </p>
<p>Before starting, using a datastore hosted by AWS is not at all mandatory, feel free to use your own if you like, but if you want to learn more about ElastiCache, this section may interest you, otherwise you can skip it.</p>
<p>Go to <a href="https://eu-west-3.console.aws.amazon.com/elasticache/home?region=eu-west-3#">AWS ElastiCache</a> and hit <strong>Get Started Now</strong>.</p><div class="centered-img">
<img src="../img/deploy-elb-8.png" /></div>
<p>For <strong>Cluster engine</strong> keep Redis.</p>
<p>Choose a <strong>Name</strong> for your datastore, for instance otoroshi-datastore.</p>
<p>You can keep all the other default values and hit <strong>Create</strong> on the bottom right of the page.</p>
<p>Once your Redis Cluster is created, it would look like the image below.</p><div class="centered-img">
<img src="../img/deploy-elb-9.png" /></div>
<p>For applications in the same security group as your cluster, redis cluster is accessible via the <strong>Primary Endpoint</strong>. Don&rsquo;t worry the default security group is fine, you don&rsquo;t need any configuration to access the cluster from Otoroshi.</p>
<p>To make Otoroshi use the created cluster, you can either use Envs <code>APP_STORAGE=redis</code>, <code>REDIS_HOST</code> and <code>REDIS_PORT</code>, or set <code>app.storage=redis</code>, <code>app.redis.host</code> and <code>app.redis.port</code> in your otoroshi.conf.</p>
<h2><a href="#create-ssl-certificate-and-configure-your-domain" name="create-ssl-certificate-and-configure-your-domain" class="anchor"><span class="anchor-link"></span></a>Create SSL certificate and configure your domain</h2>
<p>Otoroshi has now a datastore, but not yet ready for use. </p>
<p>In order to get it ready you need to :</p>
<ul>
  <li>Configure Otoroshi with your domain</li>
  <li>Create a wildcard SSL certificate for your domain</li>
  <li>Configure Otoroshi AWS Elastic Beanstalk instance with the SSL certificate</li>
  <li>Configure your DNS to redirect all traffic on your domain to Otoroshi</li>
</ul>
<h3><a href="#configure-otoroshi-with-your-domain" name="configure-otoroshi-with-your-domain" class="anchor"><span class="anchor-link"></span></a>Configure Otoroshi with your domain</h3>
<p>You can use ENVs or you can use a custom otoroshi.conf in your Docker container.</p>
<p>For the second option your otoroshi.conf would look like this :</p>
<pre><code>   include &quot;application.conf&quot;
   http.port = 8080
   app {
     env = &quot;prod&quot;
     domain = &quot;mysubdomain.oto.tools&quot;
     rootScheme = &quot;https&quot;
     snowflake {
       seed = 0
     }
     events {
       maxSize = 1000
     }
     backoffice {
       subdomain = &quot;otoroshi&quot;
       session {
         exp = 86400000
       }
     }
     
     storage = &quot;redis&quot;
     redis {
        host=&quot;myredishost&quot;
        port=myredisport
     }
   
     privateapps {
       subdomain = &quot;privateapps&quot;
     }
   
     adminapi {
       targetSubdomain = &quot;otoroshi-admin-internal-api&quot;
       exposedSubdomain = &quot;otoroshi-api&quot;
       defaultValues {
         backOfficeGroupId = &quot;admin-api-group&quot;
         backOfficeApiKeyClientId = &quot;admin-client-id&quot;
         backOfficeApiKeyClientSecret = &quot;admin-client-secret&quot;
         backOfficeServiceId = &quot;admin-api-service&quot;
       }
       proxy {
         https = true
         local = false
       }
     }
     claim {
       sharedKey = &quot;myclaimsharedkey&quot;
     }
   }
   
   play.http {
     session {
       secure = false
       httpOnly = true
       maxAge = 2147483646
       domain = &quot;.mysubdomain.oto.tools&quot;
       cookieName = &quot;oto-sess&quot;
     }
   }
</code></pre>
<h3><a href="#create-a-wildcard-ssl-certificate-for-your-domain" name="create-a-wildcard-ssl-certificate-for-your-domain" class="anchor"><span class="anchor-link"></span></a>Create a wildcard SSL certificate for your domain</h3>
<p>Go to <a href="https://eu-west-3.console.aws.amazon.com/acm/home?region=eu-west-3#/firstrun">AWS Certificate Manager</a>.</p>
<p>Below <strong>Provision certificates</strong> hit <strong>Get started</strong>.</p><div class="centered-img">
<img src="../img/deploy-elb-10.png" /></div>
<p>Keep the default selected value <strong>Request a public certificate</strong> and hit <strong>Request a certificate</strong>.</p><div class="centered-img">
<img src="../img/deploy-elb-11.png" /></div>
<p>Put your <strong>Domain name</strong>, use *. for wildcard, for instance <em>*.mysubdomain.oto.tools</em>, then hit <strong>Next</strong>.</p><div class="centered-img">
<img src="../img/deploy-elb-12.png" /></div>
<p>You can choose between <strong>Email validation</strong> and <strong>DNS validation</strong>, I&rsquo;d recommend <strong>DNS validation</strong>, then hit <strong>Review</strong>. </p><div class="centered-img">
<img src="../img/deploy-elb-13.png" /></div>
<p>Verify that you did put the right <strong>Domain name</strong> then hit <strong>Confirm and request</strong>. </p><div class="centered-img">
<img src="../img/deploy-elb-14.png" /></div>
<p>As you see in the image above, to let Amazon do the validation you have to add the <code>CNAME</code> record to your DNS configuration. Normally this operation takes around one day.</p>
<h3><a href="#configure-otoroshi-aws-elastic-beanstalk-instance-with-the-ssl-certificate" name="configure-otoroshi-aws-elastic-beanstalk-instance-with-the-ssl-certificate" class="anchor"><span class="anchor-link"></span></a>Configure Otoroshi AWS Elastic Beanstalk instance with the SSL certificate</h3>
<p>Once the certificate is validated, you need to modify the configuration of Otoroshi-env to add the SSL certificate for HTTPS. For that you need to go to <a href="https://eu-west-3.console.aws.amazon.com/elasticbeanstalk/home?region=eu-west-3#/applications">AWS Elastic Beanstalk applications</a>, hit <strong>Otoroshi-env</strong>, then on the left side hit <strong>Configuration</strong>, then on the <strong>Load balancer</strong> card hit <strong>Modify</strong>.</p><div class="centered-img">
<img src="../img/deploy-elb-15.png" /></div>
<p>In the <strong>Application Load Balancer</strong> section hit <strong>Add listener</strong>.</p><div class="centered-img">
<img src="../img/deploy-elb-16.png" /></div>
<p>Fill the popup as the image above, then hit <strong>Add</strong>. </p>
<p>You should now be seeing something like this : </p><div class="centered-img">
<img src="../img/deploy-elb-17.png" /></div>
<p>Make sure that your listener is enabled, and on the bottom right of the page hit <strong>Apply</strong>.</p>
<p>Now you have <strong>https</strong>, so let&rsquo;s use Otoroshi.</p>
<h3><a href="#configure-your-dns-to-redirect-all-traffic-on-your-domain-to-otoroshi" name="configure-your-dns-to-redirect-all-traffic-on-your-domain-to-otoroshi" class="anchor"><span class="anchor-link"></span></a>Configure your DNS to redirect all traffic on your domain to Otoroshi</h3>
<p>It&rsquo;s actually pretty simple, you just need to add a <code>CNAME</code> record to your DNS configuration, that redirects <em>*.mysubdomain.oto.tools</em> to the DNS name of Otoroshi&rsquo;s load balancer.</p>
<p>To find the DNS name of Otoroshi&rsquo;s load balancer go to <a href="https://eu-west-3.console.aws.amazon.com/ec2/v2/home?region=eu-west-3#LoadBalancers:tag:elasticbeanstalk:environment-name=Otoroshi-env;sort=loadBalancerName">AWS Ec2</a></p>
<p>You would find something like this : </p><div class="centered-img">
<img src="../img/deploy-elb-18.png" /></div>
<p>There is your DNS name, so add your <code>CNAME</code> record. </p>
<p>Once all these steps are done, the AWS Elastic Beanstalk Otoroshi instance, would now be handling all the requests on your domain. ;) </p>
<div class="nav-next">
<p><strong>Next:</strong> <a href="../deploy/other.html">Others</a></p>
</div>
</div>
<div class="large-3 show-for-large column" data-sticky-container>
<nav class="sidebar sticky" data-sticky data-anchor="docs" data-sticky-on="large">
<div class="page-nav">
<div class="nav-title">On this page:</div>
<div class="nav-toc">
<ul>
  <li><a href="../deploy/aws-beanstalk.html#aws-elastic-beanstalk" class="header">AWS - Elastic Beanstalk</a>
  <ul>
    <li><a href="../deploy/aws-beanstalk.html#aws-elastic-beanstalk-overview" class="header">AWS Elastic Beanstalk Overview</a></li>
    <li><a href="../deploy/aws-beanstalk.html#prepare-your-deployment-target" class="header">Prepare your deployment target</a></li>
    <li><a href="../deploy/aws-beanstalk.html#create-an-otoroshi-instance-on-aws-elastic-beanstalk" class="header">Create an Otoroshi instance on AWS Elastic Beanstalk</a></li>
    <li><a href="../deploy/aws-beanstalk.html#create-an-otoroshi-datastore-on-aws-elasticache" class="header">Create an Otoroshi datastore on AWS ElastiCache</a></li>
    <li><a href="../deploy/aws-beanstalk.html#create-ssl-certificate-and-configure-your-domain" class="header">Create SSL certificate and configure your domain</a></li>
  </ul></li>
</ul>
</div>
</div>
</nav>
</div>
</div>

</section>
</div>

</div>

<footer class="site-footer">

<section class="site-footer-nav">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 medium-4 large-3 text-center column">
<div class="nav-links">
<ul>
<!-- <li><a href="https://www.example.com/products/">Products</a> -->
</ul>
</div>
</div>

</div>
</div>
</div>
</section>

<section class="site-footer-base">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 text-center large-9 column">

<!--
<div class="copyright">
<span class="text">&copy; 2021</span>
<a href="https://www.example.com" class="logo">logo</a>
</div>
-->
</div>

</div>
</div>
</div>
</section>
</footer>

</div>
</div>
</div>
</body>

<script type="text/javascript" src="../lib/foundation/dist/foundation.min.js"></script>
<script type="text/javascript">jQuery(document).foundation();</script>
<script type="text/javascript" src="../js/magellan.js"></script>

<style type="text/css">@import "../lib/prettify/prettify.css";</style>
<script type="text/javascript" src="../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">jQuery(function(){window.prettyPrint && prettyPrint()});</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/elasticlunr/0.9.5/elasticlunr.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-112498312-1"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'UA-112498312-1');
</script>
</html>





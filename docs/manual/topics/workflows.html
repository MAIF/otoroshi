<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
<title>Otoroshi Workflows · Otoroshi</title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content='otoroshi-manual'/>
<link href="https://fonts.googleapis.com/css?family=Roboto:100normal,100italic,300normal,300italic,400normal,400italic,500normal,500italic,700normal,700italic,900normal,900italicc" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../js/page.js"></script>
<script type="text/javascript" src="../js/cc.js"></script>
<script type="text/javascript" src="../js/groups.js"></script>
<script type="text/javascript" src="../js/plugins.js"></script>
<script type="text/javascript" src="../js/ngplugins.js"></script>
<script type="text/javascript" src="../js/expression-language.js"></script>
<script type="text/javascript" src="../search/pagefind-ui.js"></script>
<link rel="stylesheet" type="text/css" href="../lib/normalize.css/normalize.css"/>
<link rel="stylesheet" type="text/css" href="../lib/foundation/dist/foundation.min.css"/>
<link rel="stylesheet" type="text/css" href="../css/page.css"/>
<link rel="stylesheet" type="text/css" href="../css/plugins.css"/>
<link rel="stylesheet" type="text/css" href="../search/pagefind-ui.css"/>

<!--
<link rel="shortcut icon" href="../images/favicon.ico" />
-->
</head>

<body>
<div class="off-canvas-wrapper">
<div class="off-canvas-wrapper-inner" data-off-canvas-wrapper>

<div class="off-canvas position-left" id="off-canvas-menu" data-off-canvas>
<nav class="off-canvas-nav">
<div class="nav-home">
<a href="../index.html" >
<span class="home-icon">⌂</span>Otoroshi
</a>
<div class="version-number">
latest
</div>
</div>
<div class="nav-toc">
<ul>
  <li><a href="../about.html" class="page">About Otoroshi</a></li>
  <li><a href="../architecture.html" class="page">Architecture</a></li>
  <li><a href="../features.html" class="page">Features</a></li>
  <li><a href="../getting-started.html" class="page">Getting Started</a></li>
  <li><a href="../install/index.html" class="page">Install</a>
  <ul>
    <li><a href="../install/get-otoroshi.html" class="page">Get Otoroshi</a></li>
    <li><a href="../install/setup-otoroshi.html" class="page">Setup Otoroshi</a></li>
    <li><a href="../install/run-otoroshi.html" class="page">Run Otoroshi</a></li>
  </ul></li>
  <li><a href="../entities/index.html" class="page">Main entities</a>
  <ul>
    <li><a href="../entities/routes.html" class="page">Routes</a></li>
    <li><a href="../entities/apis.html" class="page">Apis</a></li>
    <li><a href="../entities/backends.html" class="page">Backends</a></li>
    <li><a href="../entities/organizations.html" class="page">Organizations</a></li>
    <li><a href="../entities/teams.html" class="page">Teams</a></li>
    <li><a href="../entities/global-config.html" class="page">Global config</a></li>
    <li><a href="../entities/apikeys.html" class="page">Apikeys</a></li>
    <li><a href="../entities/service-groups.html" class="page">Service groups</a></li>
    <li><a href="../entities/auth-modules.html" class="page">Authentication modules</a></li>
    <li><a href="../entities/certificates.html" class="page">Certificates</a></li>
    <li><a href="../entities/jwt-verifiers.html" class="page">JWT verifiers</a></li>
    <li><a href="../entities/data-exporters.html" class="page">Data exporters</a></li>
    <li><a href="../entities/tcp-services.html" class="page">TCP services</a></li>
    <li><a href="../entities/service-descriptors.html" class="page">Service descriptors</a></li>
  </ul></li>
  <li><a href="../topics/index.html" class="page">Detailed topics</a>
  <ul>
    <li><a href="../topics/engine.html" class="page">Proxy engine</a></li>
    <li><a href="../topics/expression-language.html" class="page">Expression language</a></li>
    <li><a href="../topics/secrets.html" class="page">Secrets management</a></li>
    <li><a href="../topics/otoroshi-protocol.html" class="page">The Otoroshi communication protocol</a></li>
    <li><a href="../topics/tls.html" class="page">TLS</a></li>
    <li><a href="../topics/user-rights.html" class="page">Otoroshi user rights</a></li>
    <li><a href="../topics/events-and-analytics.html" class="page">Events and analytics</a></li>
    <li><a href="../topics/monitoring.html" class="page">Monitoring</a></li>
    <li><a href="../topics/sessions-mgmt.html" class="page">Sessions management</a></li>
    <li><a href="../topics/wasm-usage.html" class="page">Otoroshi and WASM</a></li>
    <li><a href="../topics/chaos-engineering.html" class="page">Chaos engineering with the Snow Monkey</a></li>
    <li><a href="../topics/pki.html" class="page">Otoroshi&rsquo;s PKI</a></li>
    <li><a href="../topics/dev-portal.html" class="page">Developer portal with Daikoku</a></li>
    <li><a href="../topics/graphql-composer.html" class="page">GraphQL Composer Plugin</a></li>
    <li><a href="../topics/tunnels.html" class="page">Otoroshi tunnels</a></li>
    <li><a href="../topics/relay-routing.html" class="page">Relay Routing</a></li>
    <li><a href="../topics/netty-server.html" class="page">Alternative HTTP server</a></li>
    <li><a href="../topics/http3.html" class="page">HTTP3 support</a></li>
    <li><a href="../topics/anonymous-reporting.html" class="page">Anonymous reporting</a></li>
    <li><a href="../topics/opentelemetry.html" class="page">OpenTelemetry support</a></li>
    <li><a href="../topics/green-score.html" class="page">Green Score</a></li>
    <li><a href="../topics/http-listeners.html" class="page">Custom HTTP Listeners</a></li>
    <li><a href="../topics/deprecating-sd.html" class="page">Sunsetting Service Descriptors</a></li>
    <li><a href="../topics/workflows.html" class="active page">Otoroshi Workflows</a></li>
  </ul></li>
  <li><a href="../how-to-s/index.html" class="page">How to&rsquo;s</a>
  <ul>
    <li><a href="../how-to-s/wasm-usage.html" class="page">Using wasm plugins</a></li>
    <li><a href="../how-to-s/wasmo-installation.html" class="page">Deploy your own Wasmo</a></li>
    <li><a href="../how-to-s/tailscale-integration.html" class="page">Tailscale integration</a></li>
    <li><a href="../how-to-s/end-to-end-mtls.html" class="page">End-to-end mTLS</a></li>
    <li><a href="../how-to-s/export-alerts-using-mailgun.html" class="page">Send alerts using mailgun</a></li>
    <li><a href="../how-to-s/export-events-to-elastic.html" class="page">Export events to Elasticsearch</a></li>
    <li><a href="../how-to-s/import-export-otoroshi-datastore.html" class="page">Import and export Otoroshi datastore</a></li>
    <li><a href="../how-to-s/secure-app-with-auth0.html" class="page">Secure an app with Auth0</a></li>
    <li><a href="../how-to-s/secure-app-with-keycloak.html" class="page">Secure an app with Keycloak</a></li>
    <li><a href="../how-to-s/secure-app-with-ldap.html" class="page">Secure an app and/or your Otoroshi UI with LDAP</a></li>
    <li><a href="../how-to-s/secure-with-apikey.html" class="page">Secure an api with api keys</a></li>
    <li><a href="../how-to-s/secure-with-oauth1-client.html" class="page">Secure an app with OAuth1 client flow</a></li>
    <li><a href="../how-to-s/secure-with-oauth2-client-credentials.html" class="page">Secure an app with OAuth2 client_credential flow</a></li>
    <li><a href="../how-to-s/setup-otoroshi-cluster.html" class="page">Setup an Otoroshi cluster</a></li>
    <li><a href="../how-to-s/tls-using-lets-encrypt.html" class="page">TLS termination using Let&rsquo;s Encrypt</a></li>
    <li><a href="../how-to-s/secure-an-app-with-jwt-verifiers.html" class="page">Secure an api with jwt verifiers</a></li>
    <li><a href="../how-to-s/secure-the-communication-between-a-backend-app-and-otoroshi.html" class="page">Secure the communication between a backend app and Otoroshi</a></li>
    <li><a href="../how-to-s/tls-termination-using-own-certificates.html" class="page">TLS termination using your own certificates</a></li>
    <li><a href="../how-to-s/resources-loader.html" class="page">The resources loader</a></li>
    <li><a href="../how-to-s/custom-log-levels.html" class="page">Log levels customization</a></li>
    <li><a href="../how-to-s/custom-initial-state.html" class="page">Initial state customization</a></li>
    <li><a href="../how-to-s/communicate-with-kafka.html" class="page">Communicate with Kafka</a></li>
    <li><a href="../how-to-s/create-custom-auth-module.html" class="page">Create your Authentication module</a></li>
    <li><a href="../how-to-s/working-with-eureka.html" class="page">Working with Eureka</a></li>
    <li><a href="../how-to-s/instantiate-waf-coraza.html" class="page">Instantiate a WAF with Coraza</a></li>
    <li><a href="../how-to-s/zip-backend-plugin.html" class="page">Quickly expose a website and static files</a></li>
    <li><a href="../how-to-s/calling-otoroshi-from-a-frontend.html" class="page">Calling Otoroshi from a Frontend</a></li>
  </ul></li>
  <li><a href="../plugins/index.html" class="page">Otoroshi plugins</a>
  <ul>
    <li><a href="../plugins/plugins.html" class="page">Otoroshi plugins system</a></li>
    <li><a href="../plugins/create-plugins.html" class="page">Create plugins</a></li>
    <li><a href="../plugins/built-in-plugins.html" class="page">Built-in plugins</a></li>
    <li><a href="../plugins/built-in-legacy-plugins.html" class="page">Built-in legacy plugins</a></li>
  </ul></li>
  <li><a href="../api.html" class="page">Admin REST API</a></li>
  <li><a href="../deploy/index.html" class="page">Deploy to production</a>
  <ul>
    <li><a href="../deploy/clustering.html" class="page">Otoroshi clustering</a></li>
    <li><a href="../deploy/kubernetes.html" class="page">Kubernetes</a></li>
    <li><a href="../deploy/clever-cloud.html" class="page">Clever-Cloud</a></li>
    <li><a href="../deploy/aws.html" class="page">AWS - Elastic Beanstalk</a></li>
    <li><a href="../deploy/scaling.html" class="page">Scaling Otoroshi</a></li>
  </ul></li>
  <li><a href="../dev.html" class="page">Developing Otoroshi</a></li>
  <li><a href="../search.html" class="page">Search otoroshi documentation</a></li>
</ul>
</div>

</nav>
</div>

<div class="off-canvas-content" data-off-canvas-content>

<div class="expanded row">

<div class="medium-3 large-2 show-for-medium column" style="height: 100dvh">
<nav class="site-nav">
<div class="title-logo"></div>
<div class="nav-home">
<a href="../index.html" >
<span class="home-icon">⌂</span>Otoroshi
</a>
<div class="version-number">
latest
</div>
</div>
<div class="nav-toc">
<ul>
  <li><a href="../about.html" class="page">About Otoroshi</a></li>
  <li><a href="../architecture.html" class="page">Architecture</a></li>
  <li><a href="../features.html" class="page">Features</a></li>
  <li><a href="../getting-started.html" class="page">Getting Started</a></li>
  <li><a href="../install/index.html" class="page">Install</a>
  <ul>
    <li><a href="../install/get-otoroshi.html" class="page">Get Otoroshi</a></li>
    <li><a href="../install/setup-otoroshi.html" class="page">Setup Otoroshi</a></li>
    <li><a href="../install/run-otoroshi.html" class="page">Run Otoroshi</a></li>
  </ul></li>
  <li><a href="../entities/index.html" class="page">Main entities</a>
  <ul>
    <li><a href="../entities/routes.html" class="page">Routes</a></li>
    <li><a href="../entities/apis.html" class="page">Apis</a></li>
    <li><a href="../entities/backends.html" class="page">Backends</a></li>
    <li><a href="../entities/organizations.html" class="page">Organizations</a></li>
    <li><a href="../entities/teams.html" class="page">Teams</a></li>
    <li><a href="../entities/global-config.html" class="page">Global config</a></li>
    <li><a href="../entities/apikeys.html" class="page">Apikeys</a></li>
    <li><a href="../entities/service-groups.html" class="page">Service groups</a></li>
    <li><a href="../entities/auth-modules.html" class="page">Authentication modules</a></li>
    <li><a href="../entities/certificates.html" class="page">Certificates</a></li>
    <li><a href="../entities/jwt-verifiers.html" class="page">JWT verifiers</a></li>
    <li><a href="../entities/data-exporters.html" class="page">Data exporters</a></li>
    <li><a href="../entities/tcp-services.html" class="page">TCP services</a></li>
    <li><a href="../entities/service-descriptors.html" class="page">Service descriptors</a></li>
  </ul></li>
  <li><a href="../topics/index.html" class="page">Detailed topics</a>
  <ul>
    <li><a href="../topics/engine.html" class="page">Proxy engine</a></li>
    <li><a href="../topics/expression-language.html" class="page">Expression language</a></li>
    <li><a href="../topics/secrets.html" class="page">Secrets management</a></li>
    <li><a href="../topics/otoroshi-protocol.html" class="page">The Otoroshi communication protocol</a></li>
    <li><a href="../topics/tls.html" class="page">TLS</a></li>
    <li><a href="../topics/user-rights.html" class="page">Otoroshi user rights</a></li>
    <li><a href="../topics/events-and-analytics.html" class="page">Events and analytics</a></li>
    <li><a href="../topics/monitoring.html" class="page">Monitoring</a></li>
    <li><a href="../topics/sessions-mgmt.html" class="page">Sessions management</a></li>
    <li><a href="../topics/wasm-usage.html" class="page">Otoroshi and WASM</a></li>
    <li><a href="../topics/chaos-engineering.html" class="page">Chaos engineering with the Snow Monkey</a></li>
    <li><a href="../topics/pki.html" class="page">Otoroshi&rsquo;s PKI</a></li>
    <li><a href="../topics/dev-portal.html" class="page">Developer portal with Daikoku</a></li>
    <li><a href="../topics/graphql-composer.html" class="page">GraphQL Composer Plugin</a></li>
    <li><a href="../topics/tunnels.html" class="page">Otoroshi tunnels</a></li>
    <li><a href="../topics/relay-routing.html" class="page">Relay Routing</a></li>
    <li><a href="../topics/netty-server.html" class="page">Alternative HTTP server</a></li>
    <li><a href="../topics/http3.html" class="page">HTTP3 support</a></li>
    <li><a href="../topics/anonymous-reporting.html" class="page">Anonymous reporting</a></li>
    <li><a href="../topics/opentelemetry.html" class="page">OpenTelemetry support</a></li>
    <li><a href="../topics/green-score.html" class="page">Green Score</a></li>
    <li><a href="../topics/http-listeners.html" class="page">Custom HTTP Listeners</a></li>
    <li><a href="../topics/deprecating-sd.html" class="page">Sunsetting Service Descriptors</a></li>
    <li><a href="../topics/workflows.html" class="active page">Otoroshi Workflows</a></li>
  </ul></li>
  <li><a href="../how-to-s/index.html" class="page">How to&rsquo;s</a>
  <ul>
    <li><a href="../how-to-s/wasm-usage.html" class="page">Using wasm plugins</a></li>
    <li><a href="../how-to-s/wasmo-installation.html" class="page">Deploy your own Wasmo</a></li>
    <li><a href="../how-to-s/tailscale-integration.html" class="page">Tailscale integration</a></li>
    <li><a href="../how-to-s/end-to-end-mtls.html" class="page">End-to-end mTLS</a></li>
    <li><a href="../how-to-s/export-alerts-using-mailgun.html" class="page">Send alerts using mailgun</a></li>
    <li><a href="../how-to-s/export-events-to-elastic.html" class="page">Export events to Elasticsearch</a></li>
    <li><a href="../how-to-s/import-export-otoroshi-datastore.html" class="page">Import and export Otoroshi datastore</a></li>
    <li><a href="../how-to-s/secure-app-with-auth0.html" class="page">Secure an app with Auth0</a></li>
    <li><a href="../how-to-s/secure-app-with-keycloak.html" class="page">Secure an app with Keycloak</a></li>
    <li><a href="../how-to-s/secure-app-with-ldap.html" class="page">Secure an app and/or your Otoroshi UI with LDAP</a></li>
    <li><a href="../how-to-s/secure-with-apikey.html" class="page">Secure an api with api keys</a></li>
    <li><a href="../how-to-s/secure-with-oauth1-client.html" class="page">Secure an app with OAuth1 client flow</a></li>
    <li><a href="../how-to-s/secure-with-oauth2-client-credentials.html" class="page">Secure an app with OAuth2 client_credential flow</a></li>
    <li><a href="../how-to-s/setup-otoroshi-cluster.html" class="page">Setup an Otoroshi cluster</a></li>
    <li><a href="../how-to-s/tls-using-lets-encrypt.html" class="page">TLS termination using Let&rsquo;s Encrypt</a></li>
    <li><a href="../how-to-s/secure-an-app-with-jwt-verifiers.html" class="page">Secure an api with jwt verifiers</a></li>
    <li><a href="../how-to-s/secure-the-communication-between-a-backend-app-and-otoroshi.html" class="page">Secure the communication between a backend app and Otoroshi</a></li>
    <li><a href="../how-to-s/tls-termination-using-own-certificates.html" class="page">TLS termination using your own certificates</a></li>
    <li><a href="../how-to-s/resources-loader.html" class="page">The resources loader</a></li>
    <li><a href="../how-to-s/custom-log-levels.html" class="page">Log levels customization</a></li>
    <li><a href="../how-to-s/custom-initial-state.html" class="page">Initial state customization</a></li>
    <li><a href="../how-to-s/communicate-with-kafka.html" class="page">Communicate with Kafka</a></li>
    <li><a href="../how-to-s/create-custom-auth-module.html" class="page">Create your Authentication module</a></li>
    <li><a href="../how-to-s/working-with-eureka.html" class="page">Working with Eureka</a></li>
    <li><a href="../how-to-s/instantiate-waf-coraza.html" class="page">Instantiate a WAF with Coraza</a></li>
    <li><a href="../how-to-s/zip-backend-plugin.html" class="page">Quickly expose a website and static files</a></li>
    <li><a href="../how-to-s/calling-otoroshi-from-a-frontend.html" class="page">Calling Otoroshi from a Frontend</a></li>
  </ul></li>
  <li><a href="../plugins/index.html" class="page">Otoroshi plugins</a>
  <ul>
    <li><a href="../plugins/plugins.html" class="page">Otoroshi plugins system</a></li>
    <li><a href="../plugins/create-plugins.html" class="page">Create plugins</a></li>
    <li><a href="../plugins/built-in-plugins.html" class="page">Built-in plugins</a></li>
    <li><a href="../plugins/built-in-legacy-plugins.html" class="page">Built-in legacy plugins</a></li>
  </ul></li>
  <li><a href="../api.html" class="page">Admin REST API</a></li>
  <li><a href="../deploy/index.html" class="page">Deploy to production</a>
  <ul>
    <li><a href="../deploy/clustering.html" class="page">Otoroshi clustering</a></li>
    <li><a href="../deploy/kubernetes.html" class="page">Kubernetes</a></li>
    <li><a href="../deploy/clever-cloud.html" class="page">Clever-Cloud</a></li>
    <li><a href="../deploy/aws.html" class="page">AWS - Elastic Beanstalk</a></li>
    <li><a href="../deploy/scaling.html" class="page">Scaling Otoroshi</a></li>
  </ul></li>
  <li><a href="../dev.html" class="page">Developing Otoroshi</a></li>
  <li><a href="../search.html" class="page">Search otoroshi documentation</a></li>
</ul>
</div>

</nav>
</div>

<div class="small-12 medium-9 large-10 column with-responsive-left-padding-5-rem">

<header class="site-header expanded row">
<div class="small-12 column" style="padding: 0">
<a href="#" class="off-canvas-toggle hide-for-medium" data-toggle="off-canvas-menu"><svg class="svg-icon svg-icon-menu" version="1.1" id="Menu" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve"> <path class="svg-icon-menu-path" fill="#53CDEC" d="M16.4,9H3.6C3.048,9,3,9.447,3,10c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,9.447,16.952,9,16.4,9z M16.4,13
H3.6C3.048,13,3,13.447,3,14c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,13.447,16.952,13,16.4,13z M3.6,7H16.4
C16.952,7,17,6.553,17,6c0-0.553-0.048-1-0.6-1H3.6C3.048,5,3,5.447,3,6C3,6.553,3.048,7,3.6,7z"/></svg>
</a>
<div class="title-wrapper">
<div class="title"><a href="../index.html">Otoroshi</a> <div>DOCS</div>
</div>
<!--
<a href="https://www.example.com" class="logo show-for-medium">logo</a>
-->
</div>
</header>

<section class="site-content">

<div class="page-header row">
<div class="medium-12 show-for-medium column">
<div class="nav-breadcrumbs">
<ul>
  <li><a href="../index.html">Otoroshi</a></li>
  <li><a href="../topics/index.html">Detailed topics</a></li>
  <li>Otoroshi Workflows</li>
</ul>
</div>
</div>
</div>

<div class="page-content row">
<div class="small-12 large-9 column" id="docs">
<h1><a href="#otoroshi-workflows" name="otoroshi-workflows" class="anchor"><span class="anchor-link"></span></a>Otoroshi Workflows</h1>
<p>Workflows in Otoroshi provide a powerful way to describe and execute sequences of logic using a JSON-based pseudo-language. Think of it as a lightweight alternative to tools like n8n or Apache NiFi — without the GUI (yet). Workflows let you orchestrate actions, transform data, trigger functions, and control flow based on conditional logic, all within the Otoroshi ecosystem.</p>
<h2><a href="#key-concepts" name="key-concepts" class="anchor"><span class="anchor-link"></span></a>Key Concepts</h2>
<p>There are three primary building blocks:</p>
<ul>
  <li><strong>Nodes</strong>: The execution units that form the workflow steps.</li>
  <li><strong>Functions</strong>: Reusable logic units that can be invoked by <code>call</code> nodes.</li>
  <li><strong>Operators</strong>: Data transformation helpers that let you compute, compare, transform, and extract values within the workflow.</li>
</ul>
<p>Otoroshi comes with a set of default implementations, but you can easily extend workflows with custom plugins:</p>
<pre class="prettyprint"><code class="language-scala">WorkflowFunction.registerFunction(&quot;custom.function&quot;, new MyFunction())
Node.registerNode(&quot;custom-node&quot;, new MyNode())
WorkflowOperator.registerOperator(&quot;$custom_op&quot;, new MyOperator())
</code></pre>
<h2><a href="#basic-example" name="basic-example" class="anchor"><span class="anchor-link"></span></a>Basic Example</h2>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot;: &quot;workflow&quot;,
  &quot;steps&quot;: [
    {
      &quot;kind&quot;: &quot;call&quot;,
      &quot;description&quot;: &quot;Say hello to the name passed as input&quot;,
      &quot;function&quot;: &quot;core.hello&quot;,
      &quot;args&quot;: {
        &quot;name&quot;: &quot;${input.name}&quot;
      },
      &quot;result&quot;: &quot;call_res&quot;
    }
  ],
  &quot;returned&quot;: {
    &quot;$mem_ref&quot;: {
      &quot;name&quot;: &quot;call_res&quot;
    }
  }
}
</code></pre>
<p>Input:</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;name&quot;: &quot;foo&quot;
}
</code></pre>
<p>Output:</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;returned&quot;: &quot;Hello foo !&quot;,
  &quot;error&quot;: null
}
</code></pre>
<p>Memory state:</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;call_res&quot;: &quot;Hello foo !&quot;,
  &quot;input&quot;: {
    &quot;name&quot;: &quot;foo&quot;
  }
}
</code></pre>
<h2><a href="#memory" name="memory" class="anchor"><span class="anchor-link"></span></a>Memory</h2>
<p>Each workflow execution comes with its own <strong>memory</strong>, where variables can be read from or written to. This memory enables communication between steps.</p>
<p>The <code>assign</code> node lets you manipulate memory directly, often combined with operators to compute values.</p>
<p>At any moment you can access the memory using an expression language like <code>${input.name}</code> given a memory containing something like:</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;input&quot;: {
    &quot;name&quot;: &quot;foo&quot;
  }
}
</code></pre>
<h2><a href="#nodes" name="nodes" class="anchor"><span class="anchor-link"></span></a>Nodes</h2>
<p>Each node must declare a <code>kind</code> field and can optionally define:</p>
<ul>
  <li><code>description</code> (<code>string</code>) - The description of what this node does in the workflow (optional). for debug purposes only</li>
  <li><code>result</code> (<code>string</code>) - The name of the memory that will be assigned with the result of this node (optional)</li>
  <li><code>enabled</code> (<code>boolean</code>) - Is the node enabled (optional)</li>
  <li><code>returned</code> (<code>string</code>) - Overrides the output of the node with the result of an operator (optional)</li>
  <li><code>id</code> (<code>string</code>) - id of the node (optional). for debug purposes only</li>
  <li><code>kind</code> (<code>string</code>) - The kind of the node</li>
  <li>required fields are: <strong>kind</strong></li>
</ul>
<h3><a href="#full-list-of-nodes" name="full-list-of-nodes" class="anchor"><span class="anchor-link"></span></a>Full List of Nodes</h3>
<h4><a href="#workflow" name="workflow" class="anchor"><span class="anchor-link"></span></a><code>workflow</code></h4>
<p>This node executes a sequence of nodes sequentially</p>
<p>expected configuration:</p>
<ul>
  <li><code>description</code> (<code>string</code>) - The description of what this node does in the workflow (optional). for debug purposes only</li>
  <li><code>result</code> (<code>string</code>) - The name of the memory that will be assigned with the result of this node (optional)</li>
  <li><code>enabled</code> (<code>boolean</code>) - Is the node enabled (optional)</li>
  <li><code>returned</code> (<code>string</code>) - Overrides the output of the node with the result of an operator (optional)</li>
  <li><code>id</code> (<code>string</code>) - id of the node (optional). for debug purposes only</li>
  <li><code>steps</code> (<code>array</code>) - the nodes to be executed</li>
  <li><code>kind</code> (<code>string</code>) - The kind of the node</li>
  <li>required fields are: <strong>kind</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;workflow&quot;,
  &quot;description&quot; : &quot;This node executes says hello, waits and says hello again&quot;,
  &quot;steps&quot; : [ {
    &quot;kind&quot; : &quot;call&quot;,
    &quot;function&quot; : &quot;core.hello&quot;
  }, {
    &quot;kind&quot; : &quot;wait&quot;,
    &quot;duration&quot; : 10000
  }, {
    &quot;kind&quot; : &quot;call&quot;,
    &quot;function&quot; : &quot;core.hello&quot;
  } ]
}
</code></pre>
<hr/>
<h4><a href="#switch" name="switch" class="anchor"><span class="anchor-link"></span></a><code>switch</code></h4>
<p>This node executes the first path matching a predicate</p>
<p>expected configuration:</p>
<ul>
  <li><code>description</code> (<code>string</code>) - The description of what this node does in the workflow (optional). for debug purposes only</li>
  <li><code>result</code> (<code>string</code>) - The name of the memory that will be assigned with the result of this node (optional)</li>
  <li><code>enabled</code> (<code>boolean</code>) - Is the node enabled (optional)</li>
  <li><code>paths</code> (<code>array</code>) - the nodes to be executed
    <ul>
      <li><code>predicate</code> (<code>boolean</code>) - The predicate defining if the path is run or not</li>
      <li>required fields are:</li>
    </ul>
  </li>
  <li><code>returned</code> (<code>string</code>) - Overrides the output of the node with the result of an operator (optional)</li>
  <li><code>id</code> (<code>string</code>) - id of the node (optional). for debug purposes only</li>
  <li><code>kind</code> (<code>string</code>) - The kind of the node</li>
  <li>required fields are: <strong>kind</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;switch&quot;,
  &quot;description&quot; : &quot;This node will say &#39;Hello Otoroshi 1&#39;&quot;,
  &quot;paths&quot; : [ {
    &quot;predicate&quot; : true,
    &quot;kind&quot; : &quot;call&quot;,
    &quot;function&quot; : &quot;core.hello&quot;,
    &quot;args&quot; : {
      &quot;name&quot; : &quot;Otoroshi 1&quot;
    }
  }, {
    &quot;predicate&quot; : false,
    &quot;kind&quot; : &quot;call&quot;,
    &quot;function&quot; : &quot;core.hello&quot;,
    &quot;args&quot; : {
      &quot;name&quot; : &quot;Otoroshi 2&quot;
    }
  } ]
}
</code></pre>
<hr/>
<h4><a href="#wait" name="wait" class="anchor"><span class="anchor-link"></span></a><code>wait</code></h4>
<p>This node waits a certain amount of time</p>
<p>expected configuration:</p>
<ul>
  <li><code>duration</code> (<code>number</code>) - the number of milliseconds to wait</li>
  <li><code>description</code> (<code>string</code>) - The description of what this node does in the workflow (optional). for debug purposes only</li>
  <li><code>result</code> (<code>string</code>) - The name of the memory that will be assigned with the result of this node (optional)</li>
  <li><code>enabled</code> (<code>boolean</code>) - Is the node enabled (optional)</li>
  <li><code>returned</code> (<code>string</code>) - Overrides the output of the node with the result of an operator (optional)</li>
  <li><code>id</code> (<code>string</code>) - id of the node (optional). for debug purposes only</li>
  <li><code>kind</code> (<code>string</code>) - The kind of the node</li>
  <li>required fields are: <strong>kind</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;wait&quot;,
  &quot;description&quot; : &quot;This node waits 20 seconds&quot;,
  &quot;duration&quot; : 20000
}
</code></pre>
<hr/>
<h4><a href="#parallel" name="parallel" class="anchor"><span class="anchor-link"></span></a><code>parallel</code></h4>
<p>This node executes multiple nodes in parallel</p>
<p>expected configuration:</p>
<ul>
  <li><code>description</code> (<code>string</code>) - The description of what this node does in the workflow (optional). for debug purposes only</li>
  <li><code>result</code> (<code>string</code>) - The name of the memory that will be assigned with the result of this node (optional)</li>
  <li><code>enabled</code> (<code>boolean</code>) - Is the node enabled (optional)</li>
  <li><code>paths</code> (<code>array</code>) - the nodes to be executed
    <ul>
      <li><code>predicate</code> (<code>boolean</code>) - The predicate defining if the path is run or not</li>
      <li>required fields are:</li>
    </ul>
  </li>
  <li><code>returned</code> (<code>string</code>) - Overrides the output of the node with the result of an operator (optional)</li>
  <li><code>id</code> (<code>string</code>) - id of the node (optional). for debug purposes only</li>
  <li><code>kind</code> (<code>string</code>) - The kind of the node</li>
  <li>required fields are: <strong>kind</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;parallel&quot;,
  &quot;description&quot; : &quot;This node call 3 core.hello function in parallel&quot;,
  &quot;paths&quot; : [ {
    &quot;kind&quot; : &quot;call&quot;,
    &quot;function&quot; : &quot;core.hello&quot;,
    &quot;args&quot; : {
      &quot;name&quot; : &quot;Otoroshi 1&quot;
    }
  }, {
    &quot;kind&quot; : &quot;call&quot;,
    &quot;function&quot; : &quot;core.hello&quot;,
    &quot;args&quot; : {
      &quot;name&quot; : &quot;Otoroshi 2&quot;
    }
  }, {
    &quot;kind&quot; : &quot;call&quot;,
    &quot;function&quot; : &quot;core.hello&quot;,
    &quot;args&quot; : {
      &quot;name&quot; : &quot;Otoroshi 3&quot;
    }
  } ]
}
</code></pre>
<hr/>
<h4><a href="#flatmap" name="flatmap" class="anchor"><span class="anchor-link"></span></a><code>flatmap</code></h4>
<p>This node transforms an array by applying a node on each value</p>
<p>expected configuration:</p>
<ul>
  <li><code>description</code> (<code>string</code>) - The description of what this node does in the workflow (optional). for debug purposes only</li>
  <li><code>result</code> (<code>string</code>) - The name of the memory that will be assigned with the result of this node (optional)</li>
  <li><code>enabled</code> (<code>boolean</code>) - Is the node enabled (optional)</li>
  <li><code>returned</code> (<code>string</code>) - Overrides the output of the node with the result of an operator (optional)</li>
  <li><code>id</code> (<code>string</code>) - id of the node (optional). for debug purposes only</li>
  <li><code>values</code> (<code>array</code>) - the values to iterate on</li>
  <li><code>node</code> (<code>object</code>) - the node to execute for each element in an array, should return an array to flatten it</li>
  <li><code>kind</code> (<code>string</code>) - The kind of the node</li>
  <li>required fields are: <strong>kind</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;map&quot;,
  &quot;description&quot; : &quot;This node extract all emails from users&quot;,
  &quot;values&quot; : &quot;${users}&quot;,
  &quot;node&quot; : {
    &quot;kind&quot; : &quot;value&quot;,
    &quot;value&quot; : &quot;${foreach_value.emails}&quot;
  }
}
</code></pre>
<hr/>
<h4><a href="#map" name="map" class="anchor"><span class="anchor-link"></span></a><code>map</code></h4>
<p>This node transforms an array by applying a node on each value</p>
<p>expected configuration:</p>
<ul>
  <li><code>description</code> (<code>string</code>) - The description of what this node does in the workflow (optional). for debug purposes only</li>
  <li><code>result</code> (<code>string</code>) - The name of the memory that will be assigned with the result of this node (optional)</li>
  <li><code>enabled</code> (<code>boolean</code>) - Is the node enabled (optional)</li>
  <li><code>returned</code> (<code>string</code>) - Overrides the output of the node with the result of an operator (optional)</li>
  <li><code>id</code> (<code>string</code>) - id of the node (optional). for debug purposes only</li>
  <li><code>values</code> (<code>array</code>) - the values to iterate on</li>
  <li><code>node</code> (<code>object</code>) - the node to execute for each element in an array</li>
  <li><code>kind</code> (<code>string</code>) - The kind of the node</li>
  <li>required fields are: <strong>kind</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;map&quot;,
  &quot;description&quot; : &quot;This node will transform user names&quot;,
  &quot;values&quot; : &quot;${users}&quot;,
  &quot;node&quot; : {
    &quot;kind&quot; : &quot;value&quot;,
    &quot;value&quot; : {
      &quot;$str_upper_case&quot; : &quot;${foreach_value.name}&quot;
    }
  }
}
</code></pre>
<hr/>
<h4><a href="#foreach" name="foreach" class="anchor"><span class="anchor-link"></span></a><code>foreach</code></h4>
<p>This node executes a node for each element in an array</p>
<p>expected configuration:</p>
<ul>
  <li><code>description</code> (<code>string</code>) - The description of what this node does in the workflow (optional). for debug purposes only</li>
  <li><code>result</code> (<code>string</code>) - The name of the memory that will be assigned with the result of this node (optional)</li>
  <li><code>enabled</code> (<code>boolean</code>) - Is the node enabled (optional)</li>
  <li><code>returned</code> (<code>string</code>) - Overrides the output of the node with the result of an operator (optional)</li>
  <li><code>id</code> (<code>string</code>) - id of the node (optional). for debug purposes only</li>
  <li><code>values</code> (<code>array</code>) - the values to iterate on</li>
  <li><code>node</code> (<code>object</code>) - the node to execute for each element in an array</li>
  <li><code>kind</code> (<code>string</code>) - The kind of the node</li>
  <li>required fields are: <strong>kind</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;foreach&quot;,
  &quot;description&quot; : &quot;This node execute the core.hello function for each user&quot;,
  &quot;values&quot; : &quot;${users}&quot;,
  &quot;node&quot; : {
    &quot;kind&quot; : &quot;call&quot;,
    &quot;function&quot; : &quot;core.hello&quot;,
    &quot;args&quot; : {
      &quot;name&quot; : &quot;${foreach_value.name}&quot;
    }
  }
}
</code></pre>
<hr/>
<h4><a href="#assign" name="assign" class="anchor"><span class="anchor-link"></span></a><code>assign</code></h4>
<p>This node with executes a sequence of memory assignation operations sequentially</p>
<p>expected configuration:</p>
<ul>
  <li><code>description</code> (<code>string</code>) - The description of what this node does in the workflow (optional). for debug purposes only</li>
  <li><code>result</code> (<code>string</code>) - The name of the memory that will be assigned with the result of this node (optional)</li>
  <li><code>enabled</code> (<code>boolean</code>) - Is the node enabled (optional)</li>
  <li><code>returned</code> (<code>string</code>) - Overrides the output of the node with the result of an operator (optional)</li>
  <li><code>id</code> (<code>string</code>) - id of the node (optional). for debug purposes only</li>
  <li><code>values</code> (<code>array</code>) - the assignation operations sequence
    <ul>
      <li><code>name</code> (<code>string</code>) - the name of the assignment in memory</li>
      <li><code>value</code> (<code>any</code>) - the value of the assignment</li>
      <li>required fields are: <strong>name</strong>, <strong>value</strong></li>
    </ul>
  </li>
  <li><code>kind</code> (<code>string</code>) - The kind of the node</li>
  <li>required fields are: <strong>kind</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;assign&quot;,
  &quot;description&quot; : &quot;set a counter, increment it of 2 and initialize an array in memory&quot;,
  &quot;values&quot; : [ {
    &quot;name&quot; : &quot;count&quot;,
    &quot;value&quot; : 0
  }, {
    &quot;name&quot; : &quot;count&quot;,
    &quot;value&quot; : {
      &quot;$incr&quot; : {
        &quot;value&quot; : &quot;count&quot;,
        &quot;increment&quot; : 2
      }
    }
  }, {
    &quot;name&quot; : &quot;items&quot;,
    &quot;value&quot; : [ 1, 2, 3 ]
  } ]
}
</code></pre>
<hr/>
<h4><a href="#value" name="value" class="anchor"><span class="anchor-link"></span></a><code>value</code></h4>
<p>This node executes a sequence of nodes sequentially</p>
<p>expected configuration:</p>
<ul>
  <li><code>description</code> (<code>string</code>) - The description of what this node does in the workflow (optional). for debug purposes only</li>
  <li><code>result</code> (<code>string</code>) - The name of the memory that will be assigned with the result of this node (optional)</li>
  <li><code>enabled</code> (<code>boolean</code>) - Is the node enabled (optional)</li>
  <li><code>returned</code> (<code>string</code>) - Overrides the output of the node with the result of an operator (optional)</li>
  <li><code>id</code> (<code>string</code>) - id of the node (optional). for debug purposes only</li>
  <li><code>kind</code> (<code>string</code>) - The kind of the node</li>
  <li><code>value</code> (<code>any</code>) - the returned value</li>
  <li>required fields are: <strong>kind</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;value&quot;,
  &quot;description&quot; : &quot;This node returns &#39;foo&#39;&quot;,
  &quot;value&quot; : &quot;foo&quot;
}
</code></pre>
<hr/>
<h4><a href="#if" name="if" class="anchor"><span class="anchor-link"></span></a><code>if</code></h4>
<p>This executes a node if the predicate matches or another one if not</p>
<p>expected configuration:</p>
<ul>
  <li><code>description</code> (<code>string</code>) - The description of what this node does in the workflow (optional). for debug purposes only</li>
  <li><code>result</code> (<code>string</code>) - The name of the memory that will be assigned with the result of this node (optional)</li>
  <li><code>enabled</code> (<code>boolean</code>) - Is the node enabled (optional)</li>
  <li><code>returned</code> (<code>string</code>) - Overrides the output of the node with the result of an operator (optional)</li>
  <li><code>id</code> (<code>string</code>) - id of the node (optional). for debug purposes only</li>
  <li><code>properties</code> (<code>any</code>) -</li>
  <li><code>kind</code> (<code>string</code>) - The kind of the node</li>
  <li>required fields are: <strong>kind</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;if&quot;,
  &quot;description&quot; : &quot;This node will say &#39;Hello Otoroshi 1&#39;&quot;,
  &quot;predicate&quot; : &quot;${truthyValueInMemory}&quot;,
  &quot;then&quot; : {
    &quot;kind&quot; : &quot;call&quot;,
    &quot;function&quot; : &quot;core.hello&quot;,
    &quot;args&quot; : {
      &quot;name&quot; : &quot;Otoroshi 1&quot;
    }
  },
  &quot;else&quot; : {
    &quot;kind&quot; : &quot;call&quot;,
    &quot;function&quot; : &quot;core.hello&quot;,
    &quot;args&quot; : {
      &quot;name&quot; : &quot;Otoroshi 2&quot;
    }
  }
}
</code></pre>
<hr/>
<h4><a href="#error" name="error" class="anchor"><span class="anchor-link"></span></a><code>error</code></h4>
<p>This node returns an error</p>
<p>expected configuration:</p>
<ul>
  <li><code>description</code> (<code>string</code>) - The description of what this node does in the workflow (optional). for debug purposes only</li>
  <li><code>result</code> (<code>string</code>) - The name of the memory that will be assigned with the result of this node (optional)</li>
  <li><code>enabled</code> (<code>boolean</code>) - Is the node enabled (optional)</li>
  <li><code>returned</code> (<code>string</code>) - Overrides the output of the node with the result of an operator (optional)</li>
  <li><code>id</code> (<code>string</code>) - id of the node (optional). for debug purposes only</li>
  <li><code>details</code> (<code>object</code>) - the optional details of the error</li>
  <li><code>message</code> (<code>string</code>) - the error message</li>
  <li><code>kind</code> (<code>string</code>) - The kind of the node</li>
  <li>required fields are: <strong>kind</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;error&quot;,
  &quot;description&quot; : &quot;This node fails the workflow with an error&quot;,
  &quot;message&quot; : &quot;an error occurred&quot;,
  &quot;details&quot; : {
    &quot;foo&quot; : &quot;bar&quot;
  }
}
</code></pre>
<hr/>
<h4><a href="#call" name="call" class="anchor"><span class="anchor-link"></span></a><code>call</code></h4>
<p>This node calls a function an returns its result</p>
<p>expected configuration:</p>
<ul>
  <li><code>description</code> (<code>string</code>) - The description of what this node does in the workflow (optional). for debug purposes only</li>
  <li><code>result</code> (<code>string</code>) - The name of the memory that will be assigned with the result of this node (optional)</li>
  <li><code>enabled</code> (<code>boolean</code>) - Is the node enabled (optional)</li>
  <li><code>returned</code> (<code>string</code>) - Overrides the output of the node with the result of an operator (optional)</li>
  <li><code>id</code> (<code>string</code>) - id of the node (optional). for debug purposes only</li>
  <li><code>function</code> (<code>string</code>) - the function name</li>
  <li><code>args</code> (<code>object</code>) - the arguments of the call</li>
  <li><code>kind</code> (<code>string</code>) - The kind of the node</li>
  <li>required fields are: <strong>kind</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;call&quot;,
  &quot;description&quot; : &quot;This node call the core.hello function&quot;,
  &quot;function&quot; : &quot;core.hello&quot;,
  &quot;args&quot; : {
    &quot;name&quot; : &quot;Otoroshi&quot;
  }
}
</code></pre>
<hr/>
<h4><a href="#filter" name="filter" class="anchor"><span class="anchor-link"></span></a><code>filter</code></h4>
<p>This node transforms an array by filtering values based on a node execution</p>
<p>expected configuration:</p>
<ul>
  <li><code>predicate</code> (<code>object</code>) - the node to execute for each element in an array</li>
  <li><code>description</code> (<code>string</code>) - The description of what this node does in the workflow (optional). for debug purposes only</li>
  <li><code>result</code> (<code>string</code>) - The name of the memory that will be assigned with the result of this node (optional)</li>
  <li><code>enabled</code> (<code>boolean</code>) - Is the node enabled (optional)</li>
  <li><code>returned</code> (<code>string</code>) - Overrides the output of the node with the result of an operator (optional)</li>
  <li><code>id</code> (<code>string</code>) - id of the node (optional). for debug purposes only</li>
  <li><code>values</code> (<code>array</code>) - the values to iterate on</li>
  <li><code>kind</code> (<code>string</code>) - The kind of the node</li>
  <li>required fields are: <strong>kind</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;filter&quot;,
  &quot;description&quot; : &quot;This node will filter out users that are not admins&quot;,
  &quot;values&quot; : &quot;${users}&quot;,
  &quot;predicate&quot; : {
    &quot;kind&quot; : &quot;value&quot;,
    &quot;value&quot; : &quot;${foreach_value.admin}&quot;
  }
}
</code></pre>
<h2><a href="#functions" name="functions" class="anchor"><span class="anchor-link"></span></a>Functions</h2>
<p>Workflow functions are reusable logic blocks invoked via <code>call</code> nodes.</p>
<p>Prototype:</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot;: &quot;call&quot;,
  &quot;function&quot;: &quot;&lt;function_name&gt;&quot;,
  &quot;args&quot;: { ... },
  &quot;result&quot;: &quot;&lt;memory_var_name&gt;&quot;
}
</code></pre>
<h3><a href="#full-list-of-functions" name="full-list-of-functions" class="anchor"><span class="anchor-link"></span></a>Full List of Functions</h3>
<h4><a href="#core-store-get" name="core-store-get" class="anchor"><span class="anchor-link"></span></a><code>core.store_get</code></h4>
<p>This function gets keys from the store</p>
<p>expected configuration:</p>
<ul>
  <li><code>key</code> (<code>string</code>) - The key to get</li>
  <li>required fields are: <strong>key</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;call&quot;,
  &quot;function&quot; : &quot;core.store_get&quot;,
  &quot;args&quot; : {
    &quot;key&quot; : &quot;my_key&quot;
  }
}
</code></pre>
<hr/>
<h4><a href="#core-file-read" name="core-file-read" class="anchor"><span class="anchor-link"></span></a><code>core.file_read</code></h4>
<p>This function reads a file</p>
<p>expected configuration:</p>
<ul>
  <li><code>path</code> (<code>string</code>) - The path of the file to read</li>
  <li><code>parse_json</code> (<code>boolean</code>) - Whether to parse the file as JSON</li>
  <li><code>encode_base64</code> (<code>boolean</code>) - Whether to encode the file content in base64</li>
  <li>required fields are: <strong>path</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;call&quot;,
  &quot;function&quot; : &quot;core.file_read&quot;,
  &quot;args&quot; : {
    &quot;path&quot; : &quot;/path/to/file.txt&quot;,
    &quot;parse_json&quot; : true,
    &quot;encode_base64&quot; : true
  }
}
</code></pre>
<hr/>
<h4><a href="#core-hello" name="core-hello" class="anchor"><span class="anchor-link"></span></a><code>core.hello</code></h4>
<p>This function returns a hello message</p>
<p>expected configuration:</p>
<ul>
  <li><code>name</code> (<code>string</code>) - The name of the person to greet</li>
  <li>required fields are: <strong>name</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;call&quot;,
  &quot;function&quot; : &quot;core.hello&quot;,
  &quot;args&quot; : {
    &quot;name&quot; : &quot;Otoroshi&quot;
  }
}
</code></pre>
<hr/>
<h4><a href="#core-store-match" name="core-store-match" class="anchor"><span class="anchor-link"></span></a><code>core.store_match</code></h4>
<p>This function gets keys from the store matching a pattern</p>
<p>expected configuration:</p>
<ul>
  <li><code>pattern</code> (<code>string</code>) - The pattern to match</li>
  <li>required fields are: <strong>pattern</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;call&quot;,
  &quot;function&quot; : &quot;core.store_match&quot;,
  &quot;args&quot; : {
    &quot;pattern&quot; : &quot;my_pattern:*&quot;
  }
}
</code></pre>
<hr/>
<h4><a href="#core-store-set" name="core-store-set" class="anchor"><span class="anchor-link"></span></a><code>core.store_set</code></h4>
<p>This function sets a key in the store</p>
<p>expected configuration:</p>
<ul>
  <li><code>key</code> (<code>string</code>) - The key to set</li>
  <li><code>value</code> (<code>string</code>) - The value to set</li>
  <li><code>ttl</code> (<code>number</code>) - The optional time to live in seconds</li>
  <li>required fields are: <strong>key</strong>, <strong>value</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;call&quot;,
  &quot;function&quot; : &quot;core.store_set&quot;,
  &quot;args&quot; : {
    &quot;key&quot; : &quot;my_key&quot;,
    &quot;value&quot; : &quot;my_value&quot;,
    &quot;ttl&quot; : 3600
  }
}
</code></pre>
<hr/>
<h4><a href="#core-wasm-call" name="core-wasm-call" class="anchor"><span class="anchor-link"></span></a><code>core.wasm_call</code></h4>
<p>This function calls a wasm function</p>
<p>expected configuration:</p>
<ul>
  <li><code>wasm_plugin</code> (<code>string</code>) - The wasm plugin to use</li>
  <li><code>function</code> (<code>string</code>) - The function to call</li>
  <li><code>params</code> (<code>object</code>) - The parameters to passed to the function</li>
  <li>required fields are: <strong>wasm_plugin</strong>, <strong>function</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;call&quot;,
  &quot;function&quot; : &quot;core.wasm_call&quot;,
  &quot;args&quot; : {
    &quot;wasm_plugin&quot; : &quot;my_wasm_plugin&quot;,
    &quot;function&quot; : &quot;my_function&quot;,
    &quot;params&quot; : {
      &quot;foo&quot; : &quot;bar&quot;
    }
  }
}
</code></pre>
<hr/>
<h4><a href="#core-file-del" name="core-file-del" class="anchor"><span class="anchor-link"></span></a><code>core.file_del</code></h4>
<p>This function deletes a file</p>
<p>expected configuration:</p>
<ul>
  <li><code>path</code> (<code>string</code>) - The path of the file to delete</li>
  <li>required fields are: <strong>path</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;call&quot;,
  &quot;function&quot; : &quot;core.file_delete&quot;,
  &quot;args&quot; : {
    &quot;path&quot; : &quot;/path/to/file.txt&quot;
  }
}
</code></pre>
<hr/>
<h4><a href="#core-store-keys" name="core-store-keys" class="anchor"><span class="anchor-link"></span></a><code>core.store_keys</code></h4>
<p>This function gets keys from the store</p>
<p>expected configuration:</p>
<ul>
  <li><code>pattern</code> (<code>string</code>) - The pattern to match</li>
  <li>required fields are: <strong>pattern</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;call&quot;,
  &quot;function&quot; : &quot;core.store_keys&quot;,
  &quot;args&quot; : {
    &quot;pattern&quot; : &quot;my_pattern:*&quot;
  }
}
</code></pre>
<hr/>
<h4><a href="#core-log" name="core-log" class="anchor"><span class="anchor-link"></span></a><code>core.log</code></h4>
<p>This function writes whatever the user want to the otoroshi logs</p>
<p>expected configuration:</p>
<ul>
  <li><code>message</code> (<code>string</code>) - The message to log</li>
  <li><code>params</code> (<code>array</code>) - The parameters to log</li>
  <li>required fields are: <strong>message</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;call&quot;,
  &quot;function&quot; : &quot;core.log&quot;,
  &quot;args&quot; : {
    &quot;message&quot; : &quot;Hello&quot;,
    &quot;params&quot; : [ &quot;World&quot; ]
  }
}
</code></pre>
<hr/>
<h4><a href="#core-http-client" name="core-http-client" class="anchor"><span class="anchor-link"></span></a><code>core.http_client</code></h4>
<p>This function makes a HTTP request</p>
<p>expected configuration:</p>
<ul>
  <li><code>tls_config</code> (<code>object</code>) - The TLS configuration</li>
  <li><code>method</code> (<code>string</code>) - The HTTP method to use</li>
  <li><code>body</code> (<code>string</code>) - The body (string) to send</li>
  <li><code>url</code> (<code>string</code>) - The URL to call</li>
  <li><code>body_bytes</code> (<code>array</code>) - The body (bytes array) to send</li>
  <li><code>body_json</code> (<code>object</code>) - The body (json) to send</li>
  <li><code>body_str</code> (<code>string</code>) - The body (string) to send</li>
  <li><code>body_base64</code> (<code>string</code>) - The body (base64) to send</li>
  <li><code>headers</code> (<code>object</code>) - The headers to send</li>
  <li><code>timeout</code> (<code>number</code>) - The timeout in milliseconds</li>
  <li>required fields are: <strong>url</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;call&quot;,
  &quot;function&quot; : &quot;core.http_client&quot;,
  &quot;args&quot; : {
    &quot;url&quot; : &quot;https://httpbin.org/get&quot;,
    &quot;method&quot; : &quot;GET&quot;,
    &quot;headers&quot; : {
      &quot;User-Agent&quot; : &quot;Otoroshi&quot;
    },
    &quot;timeout&quot; : 30000,
    &quot;body_json&quot; : {
      &quot;foo&quot; : &quot;bar&quot;
    }
  }
}
</code></pre>
<hr/>
<h4><a href="#core-send-mail" name="core-send-mail" class="anchor"><span class="anchor-link"></span></a><code>core.send_mail</code></h4>
<p>This function sends an email</p>
<p>expected configuration:</p>
<ul>
  <li><code>mailer_config</code> (<code>object</code>) - The mailer configuration</li>
  <li><code>subject</code> (<code>string</code>) - The email subject</li>
  <li><code>to</code> (<code>array</code>) - The recipient email addresses</li>
  <li><code>from</code> (<code>string</code>) - The sender email address</li>
  <li><code>html</code> (<code>string</code>) - The email HTML content</li>
  <li>required fields are: <strong>from</strong>, <strong>to</strong>, <strong>subject</strong>, <strong>html</strong>, <strong>mailer_config</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;call&quot;,
  &quot;function&quot; : &quot;core.send_mail&quot;,
  &quot;args&quot; : {
    &quot;from&quot; : &quot;sender@example.com&quot;,
    &quot;to&quot; : [ &quot;recipient@example.com&quot; ],
    &quot;subject&quot; : &quot;Test email&quot;,
    &quot;html&quot; : &quot;Hello, this is a test email&quot;,
    &quot;mailer_config&quot; : {
      &quot;kind&quot; : &quot;mailgun&quot;,
      &quot;api_key&quot; : &quot;your_api_key&quot;,
      &quot;domain&quot; : &quot;your_domain&quot;
    }
  }
}
</code></pre>
<hr/>
<h4><a href="#core-system-call" name="core-system-call" class="anchor"><span class="anchor-link"></span></a><code>core.system_call</code></h4>
<p>This function calls a system command</p>
<p>expected configuration:</p>
<ul>
  <li><code>command</code> (<code>array</code>) - The command to execute</li>
  <li>required fields are: <strong>command</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;call&quot;,
  &quot;function&quot; : &quot;core.system_call&quot;,
  &quot;args&quot; : {
    &quot;command&quot; : [ &quot;ls&quot;, &quot;-l&quot; ]
  }
}
</code></pre>
<hr/>
<h4><a href="#core-state-get-all" name="core-state-get-all" class="anchor"><span class="anchor-link"></span></a><code>core.state_get_all</code></h4>
<p>This function gets all resources from the state</p>
<p>expected configuration:</p>
<ul>
  <li><code>name</code> (<code>string</code>) - The name of the resource</li>
  <li><code>group</code> (<code>string</code>) - The group of the resource</li>
  <li><code>version</code> (<code>string</code>) - The version of the resource</li>
  <li>required fields are: <strong>name</strong>, <strong>group</strong>, <strong>version</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;call&quot;,
  &quot;function&quot; : &quot;core.state_get_all&quot;,
  &quot;args&quot; : {
    &quot;name&quot; : &quot;my_resource&quot;,
    &quot;group&quot; : &quot;my_group&quot;,
    &quot;version&quot; : &quot;my_version&quot;
  }
}
</code></pre>
<hr/>
<h4><a href="#core-store-del" name="core-store-del" class="anchor"><span class="anchor-link"></span></a><code>core.store_del</code></h4>
<p>This function deletes keys from the store</p>
<p>expected configuration:</p>
<ul>
  <li><code>keys</code> (<code>array</code>) - The keys to delete</li>
  <li>required fields are: <strong>keys</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;call&quot;,
  &quot;function&quot; : &quot;core.store_del&quot;,
  &quot;args&quot; : {
    &quot;keys&quot; : [ &quot;key1&quot;, &quot;key2&quot; ]
  }
}
</code></pre>
<hr/>
<h4><a href="#core-file-write" name="core-file-write" class="anchor"><span class="anchor-link"></span></a><code>core.file_write</code></h4>
<p>This function writes a file</p>
<p>expected configuration:</p>
<ul>
  <li><code>path</code> (<code>string</code>) - The path of the file to write</li>
  <li><code>value</code> (<code>string</code>) - The value to write</li>
  <li><code>prettify</code> (<code>boolean</code>) - Whether to prettify the JSON</li>
  <li><code>from_base64</code> (<code>boolean</code>) - Whether to decode the base64 content</li>
  <li>required fields are: <strong>path</strong>, <strong>value</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;call&quot;,
  &quot;function&quot; : &quot;core.file_write&quot;,
  &quot;args&quot; : {
    &quot;path&quot; : &quot;/path/to/file.txt&quot;,
    &quot;value&quot; : &quot;my_value&quot;,
    &quot;prettify&quot; : true,
    &quot;from_base64&quot; : true
  }
}
</code></pre>
<hr/>
<h4><a href="#core-workflow-call" name="core-workflow-call" class="anchor"><span class="anchor-link"></span></a><code>core.workflow_call</code></h4>
<p>This function calls another workflow stored in otoroshi</p>
<p>expected configuration:</p>
<ul>
  <li><code>workflow_id</code> (<code>string</code>) - The ID of the workflow to call</li>
  <li><code>input</code> (<code>object</code>) - The input of the workflow</li>
  <li>required fields are: <strong>workflow_id</strong>, <strong>input</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;call&quot;,
  &quot;function&quot; : &quot;core.workflow_call&quot;,
  &quot;args&quot; : {
    &quot;workflow_id&quot; : &quot;my_workflow_id&quot;,
    &quot;input&quot; : {
      &quot;foo&quot; : &quot;bar&quot;
    }
  }
}
</code></pre>
<hr/>
<h4><a href="#core-state-get" name="core-state-get" class="anchor"><span class="anchor-link"></span></a><code>core.state_get</code></h4>
<p>This function gets a resource from the state</p>
<p>expected configuration:</p>
<ul>
  <li><code>id</code> (<code>string</code>) - The ID of the resource</li>
  <li><code>name</code> (<code>string</code>) - The name of the resource</li>
  <li><code>group</code> (<code>string</code>) - The group of the resource</li>
  <li><code>version</code> (<code>string</code>) - The version of the resource</li>
  <li>required fields are: <strong>id</strong>, <strong>name</strong>, <strong>group</strong>, <strong>version</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;call&quot;,
  &quot;function&quot; : &quot;core.state_get_one&quot;,
  &quot;args&quot; : {
    &quot;id&quot; : &quot;my_id&quot;,
    &quot;name&quot; : &quot;my_resource&quot;,
    &quot;group&quot; : &quot;my_group&quot;,
    &quot;version&quot; : &quot;my_version&quot;
  }
}
</code></pre>
<hr/>
<h4><a href="#core-store-mget" name="core-store-mget" class="anchor"><span class="anchor-link"></span></a><code>core.store_mget</code></h4>
<p>This function gets multiple keys from the store</p>
<p>expected configuration:</p>
<ul>
  <li><code>keys</code> (<code>array</code>) - The keys to get</li>
  <li>required fields are: <strong>keys</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;call&quot;,
  &quot;function&quot; : &quot;core.store_mget&quot;,
  &quot;args&quot; : {
    &quot;keys&quot; : [ &quot;key1&quot;, &quot;key2&quot; ]
  }
}
</code></pre>
<hr/>
<h4><a href="#core-emit-event" name="core-emit-event" class="anchor"><span class="anchor-link"></span></a><code>core.emit_event</code></h4>
<p>This function emits an event</p>
<p>expected configuration:</p>
<ul>
  <li><code>event</code> (<code>object</code>) - The event to emit</li>
  <li>required fields are: <strong>event</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot; : &quot;call&quot;,
  &quot;function&quot; : &quot;core.emit_event&quot;,
  &quot;args&quot; : {
    &quot;event&quot; : {
      &quot;type&quot; : &quot;object&quot;,
      &quot;properties&quot; : {
        &quot;name&quot; : {
          &quot;type&quot; : &quot;string&quot;,
          &quot;description&quot; : &quot;The name of the event&quot;
        }
      }
    }
  }
}
</code></pre>
<h2><a href="#operators" name="operators" class="anchor"><span class="anchor-link"></span></a>Operators</h2>
<p>Operators are one-key JSON objects (e.g. <code>{ &quot;$eq&quot;: { ... } }</code>) used to manipulate data. They can:</p>
<ul>
  <li>Navigate and extract memory (<code>$mem_ref</code>)</li>
  <li>Transform strings (<code>$str_concat</code>, <code>$encode_base64</code>, <code>$decode_base64</code>)</li>
  <li>Compare values (<code>$eq</code>, <code>$gt</code>, <code>$lt</code>, <code>$gte</code>, <code>$lte</code>, <code>$neq</code>)</li>
  <li>Evaluate truthiness (<code>$is_truthy</code>, <code>$is_falsy</code>, <code>$not</code>)</li>
  <li>Work with arrays/maps (<code>$array_append</code>, <code>$array_prepend</code>, <code>$array_at</code>, <code>$array_del</code>, <code>$array_page</code>, <code>$map_get</code>, <code>$map_put</code>, <code>$map_del</code>)</li>
  <li>Perform math (<code>$add</code>, <code>$subtract</code>, <code>$multiply</code>, <code>$divide</code>)</li>
  <li>Parse and format dates/times (<code>$parse_datetime</code>, <code>$parse_date</code>, <code>$parse_time</code>, <code>$now</code>)</li>
  <li>Parse and project JSON (<code>$json_parse</code>, <code>$projection</code>)</li>
  <li>Perform expression evaluation (<code>$expression_language</code>)</li>
  <li>Create auth headers (<code>$basic_auth</code>)</li>
  <li>Check containment (<code>$contains</code>)</li>
</ul>
<p>Example:</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$eq&quot;: {
    &quot;a&quot;: &quot;foo&quot;,
    &quot;b&quot;: &quot;bar&quot;
  }
}
</code></pre>
<p>Result: <code>false</code></p>
<h3><a href="#full-list-of-operators" name="full-list-of-operators" class="anchor"><span class="anchor-link"></span></a>Full List of Operators</h3>
<h4><a href="#basic-auth" name="basic-auth" class="anchor"><span class="anchor-link"></span></a><code>$basic_auth</code></h4>
<p>This operator returns a basic authentication header</p>
<p>expected configuration:</p>
<ul>
  <li><code>user</code> (<code>string</code>) - The username</li>
  <li><code>password</code> (<code>string</code>) - The password</li>
  <li>required fields are: <strong>user</strong>, <strong>password</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$basic_auth&quot; : {
    &quot;user&quot; : &quot;username&quot;,
    &quot;password&quot; : &quot;password&quot;
  }
}
</code></pre>
<hr/>
<h4><a href="#eq" name="eq" class="anchor"><span class="anchor-link"></span></a><code>$eq</code></h4>
<p>This operator checks if two values are equal</p>
<p>expected configuration:</p>
<ul>
  <li><code>a</code> (<code>any</code>) - The first value</li>
  <li><code>b</code> (<code>any</code>) - The second value</li>
  <li>required fields are: <strong>a</strong>, <strong>b</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$eq&quot; : {
    &quot;a&quot; : 1,
    &quot;b&quot; : 1
  }
}
</code></pre>
<hr/>
<h4><a href="#now" name="now" class="anchor"><span class="anchor-link"></span></a><code>$now</code></h4>
<p>This operator returns the current timestamp</p>
<p>expected configuration:</p>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$now&quot; : { }
}
</code></pre>
<hr/>
<h4><a href="#is-falsy" name="is-falsy" class="anchor"><span class="anchor-link"></span></a><code>$is_falsy</code></h4>
<p>This operator checks if a value is falsy</p>
<p>expected configuration:</p>
<ul>
  <li><code>value</code> (<code>any</code>) - The value to check</li>
  <li>required fields are: <strong>value</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$is_falsy&quot; : {
    &quot;value&quot; : 0
  }
}
</code></pre>
<hr/>
<h4><a href="#add" name="add" class="anchor"><span class="anchor-link"></span></a><code>$add</code></h4>
<p>This operator adds a list of numbers</p>
<p>expected configuration:</p>
<ul>
  <li><code>values</code> (<code>array</code>) - The list of numbers to add</li>
  <li>required fields are: <strong>values</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$add&quot; : {
    &quot;values&quot; : [ 1, 2, 3 ]
  }
}
</code></pre>
<hr/>
<h4><a href="#array-append" name="array-append" class="anchor"><span class="anchor-link"></span></a><code>$array_append</code></h4>
<p>This operator appends a value to an array</p>
<p>expected configuration:</p>
<ul>
  <li><code>value</code> (<code>any</code>) - The value to append</li>
  <li><code>array</code> (<code>array</code>) - The array to append the value to</li>
  <li>required fields are: <strong>value</strong>, <strong>array</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$array_append&quot; : {
    &quot;value&quot; : &quot;my_value&quot;,
    &quot;array&quot; : [ &quot;my_value&quot; ]
  }
}
</code></pre>
<hr/>
<h4><a href="#neq" name="neq" class="anchor"><span class="anchor-link"></span></a><code>$neq</code></h4>
<p>This operator checks if two values are not equal</p>
<p>expected configuration:</p>
<ul>
  <li><code>a</code> (<code>any</code>) - The first value</li>
  <li><code>b</code> (<code>any</code>) - The second value</li>
  <li>required fields are: <strong>a</strong>, <strong>b</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$neq&quot; : {
    &quot;a&quot; : 1,
    &quot;b&quot; : 2
  }
}
</code></pre>
<hr/>
<h4><a href="#array-at" name="array-at" class="anchor"><span class="anchor-link"></span></a><code>$array_at</code></h4>
<p>This operator gets an element from an array</p>
<p>expected configuration:</p>
<ul>
  <li><code>idx</code> (<code>integer</code>) - The index of the element to get</li>
  <li><code>array</code> (<code>array</code>) - The array to get the element from</li>
  <li>required fields are: <strong>idx</strong>, <strong>array</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$array_at&quot; : {
    &quot;idx&quot; : 0,
    &quot;array&quot; : [ &quot;my_value&quot; ]
  }
}
</code></pre>
<hr/>
<h4><a href="#parse-date" name="parse-date" class="anchor"><span class="anchor-link"></span></a><code>$parse_date</code></h4>
<p>This operator parses a date string into a timestamp</p>
<p>expected configuration:</p>
<ul>
  <li><code>value</code> (<code>string</code>) - The date string to parse</li>
  <li><code>pattern</code> (<code>string</code>) - The pattern to use for parsing</li>
  <li>required fields are: <strong>value</strong>, <strong>pattern</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$parse_date&quot; : {
    &quot;value&quot; : &quot;2023-01-01&quot;,
    &quot;pattern&quot; : &quot;yyyy-MM-dd&quot;
  }
}
</code></pre>
<hr/>
<h4><a href="#parse-datetime" name="parse-datetime" class="anchor"><span class="anchor-link"></span></a><code>$parse_datetime</code></h4>
<p>This operator parses a datetime string into a timestamp</p>
<p>expected configuration:</p>
<ul>
  <li><code>value</code> (<code>string</code>) - The datetime string to parse</li>
  <li><code>pattern</code> (<code>string</code>) - The pattern to use for parsing</li>
  <li>required fields are: <strong>value</strong>, <strong>pattern</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$parse_datetime&quot; : {
    &quot;value&quot; : &quot;2023-01-01T00:00:00&quot;,
    &quot;pattern&quot; : &quot;yyyy-MM-dd&#39;T&#39;HH:mm:ss&quot;
  }
}
</code></pre>
<hr/>
<h4><a href="#array-page" name="array-page" class="anchor"><span class="anchor-link"></span></a><code>$array_page</code></h4>
<p>This operator gets a page of an array</p>
<p>expected configuration:</p>
<ul>
  <li><code>page</code> (<code>integer</code>) - The page number</li>
  <li><code>page_size</code> (<code>integer</code>) - The page size</li>
  <li><code>array</code> (<code>array</code>) - The array to get the page from</li>
  <li>required fields are: <strong>page</strong>, <strong>page_size</strong>, <strong>array</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$array_page&quot; : {
    &quot;page&quot; : 1,
    &quot;page_size&quot; : 10,
    &quot;array&quot; : [ &quot;my_value&quot; ]
  }
}
</code></pre>
<hr/>
<h4><a href="#map-get" name="map-get" class="anchor"><span class="anchor-link"></span></a><code>$map_get</code></h4>
<p>This operator gets a value from a map</p>
<p>expected configuration:</p>
<ul>
  <li><code>key</code> (<code>string</code>) - The key to get</li>
  <li><code>map</code> (<code>object</code>) - The map to get the value from</li>
  <li>required fields are: <strong>key</strong>, <strong>map</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$map_get&quot; : {
    &quot;key&quot; : &quot;my_key&quot;,
    &quot;map&quot; : {
      &quot;my_key&quot; : &quot;my_value&quot;
    }
  }
}
</code></pre>
<hr/>
<h4><a href="#parse-time" name="parse-time" class="anchor"><span class="anchor-link"></span></a><code>$parse_time</code></h4>
<p>This operator parses a time string into a timestamp</p>
<p>expected configuration:</p>
<ul>
  <li><code>value</code> (<code>string</code>) - The time string to parse</li>
  <li><code>pattern</code> (<code>string</code>) - The pattern to use for parsing</li>
  <li>required fields are: <strong>value</strong>, <strong>pattern</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$parse_time&quot; : {
    &quot;value&quot; : &quot;00:00:00&quot;,
    &quot;pattern&quot; : &quot;HH:mm:ss&quot;
  }
}
</code></pre>
<hr/>
<h4><a href="#mem-ref" name="mem-ref" class="anchor"><span class="anchor-link"></span></a><code>$mem_ref</code></h4>
<p>This operator gets a value from the memory</p>
<p>expected configuration:</p>
<ul>
  <li><code>name</code> (<code>string</code>) - The name of the memory entry</li>
  <li><code>path</code> (<code>string</code>) - The path of the memory entry</li>
  <li>required fields are: <strong>name</strong>, <strong>path</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$memref&quot; : {
    &quot;name&quot; : &quot;my_memory&quot;,
    &quot;path&quot; : &quot;my_path&quot;
  }
}
</code></pre>
<hr/>
<h4><a href="#str-lower-case" name="str-lower-case" class="anchor"><span class="anchor-link"></span></a><code>$str_lower_case</code></h4>
<p>This operator converts a string to lowercase</p>
<p>expected configuration:</p>
<ul>
  <li><code>value</code> (<code>string</code>) - The string to convert to lowercase</li>
  <li>required fields are: <strong>value</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$str_lower_case&quot; : {
    &quot;value&quot; : &quot;hello&quot;
  }
}
</code></pre>
<hr/>
<h4><a href="#encode-base64" name="encode-base64" class="anchor"><span class="anchor-link"></span></a><code>$encode_base64</code></h4>
<p>This operator encodes a string in base64</p>
<p>expected configuration:</p>
<ul>
  <li><code>value</code> (<code>string</code>) - The string to encode in base64</li>
  <li>required fields are: <strong>value</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$encode_base64&quot; : {
    &quot;value&quot; : &quot;Hello, World!&quot;
  }
}
</code></pre>
<hr/>
<h4><a href="#expression-language" name="expression-language" class="anchor"><span class="anchor-link"></span></a><code>$expression_language</code></h4>
<p>This operator evaluates an expression language</p>
<p>expected configuration:</p>
<ul>
  <li><code>expression</code> (<code>string</code>) - The expression to evaluate</li>
  <li>required fields are: <strong>expression</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$expression_language&quot; : {
    &quot;expression&quot; : &quot;${req.headers.X-Custom-Header}&quot;
  }
}
</code></pre>
<hr/>
<h4><a href="#not" name="not" class="anchor"><span class="anchor-link"></span></a><code>$not</code></h4>
<p>This operator negates a boolean value</p>
<p>expected configuration:</p>
<ul>
  <li><code>value</code> (<code>boolean</code>) - The boolean value to negate</li>
  <li>required fields are: <strong>value</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$not&quot; : {
    &quot;value&quot; : true
  }
}
</code></pre>
<hr/>
<h4><a href="#projection" name="projection" class="anchor"><span class="anchor-link"></span></a><code>$projection</code></h4>
<p>This operator projects a value</p>
<p>expected configuration:</p>
<ul>
  <li><code>projection</code> (<code>object</code>) - The projection to apply</li>
  <li><code>value</code> (<code>object</code>) - The value to project</li>
  <li>required fields are: <strong>projection</strong>, <strong>value</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$projection&quot; : {
    &quot;projection&quot; : {
      &quot;name&quot; : &quot;my_name&quot;
    },
    &quot;value&quot; : {
      &quot;name&quot; : &quot;my_name&quot;
    }
  }
}
</code></pre>
<hr/>
<h4><a href="#lte" name="lte" class="anchor"><span class="anchor-link"></span></a><code>$lte</code></h4>
<p>This operator checks if a number is less than or equal to another number</p>
<p>expected configuration:</p>
<ul>
  <li><code>a</code> (<code>number</code>) - The first number</li>
  <li><code>b</code> (<code>number</code>) - The second number</li>
  <li>required fields are: <strong>a</strong>, <strong>b</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$lte&quot; : {
    &quot;a&quot; : 1,
    &quot;b&quot; : 0
  }
}
</code></pre>
<hr/>
<h4><a href="#str-split" name="str-split" class="anchor"><span class="anchor-link"></span></a><code>$str_split</code></h4>
<p>This operator splits a string into an array based on a regex</p>
<p>expected configuration:</p>
<ul>
  <li><code>value</code> (<code>string</code>) - The string to split</li>
  <li><code>regex</code> (<code>string</code>) - The regex to use for splitting</li>
  <li>required fields are: <strong>value</strong>, <strong>regex</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$str_split&quot; : {
    &quot;value&quot; : &quot;hello,world&quot;,
    &quot;regex&quot; : &quot;,&quot;
  }
}
</code></pre>
<hr/>
<h4><a href="#array-prepend" name="array-prepend" class="anchor"><span class="anchor-link"></span></a><code>$array_prepend</code></h4>
<p>This operator prepends a value to an array</p>
<p>expected configuration:</p>
<ul>
  <li><code>value</code> (<code>any</code>) - The value to prepend</li>
  <li><code>array</code> (<code>array</code>) - The array to prepend the value to</li>
  <li>required fields are: <strong>value</strong>, <strong>array</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$array_prepend&quot; : {
    &quot;value&quot; : &quot;my_value&quot;,
    &quot;array&quot; : [ &quot;my_value&quot; ]
  }
}
</code></pre>
<hr/>
<h4><a href="#decode-base64" name="decode-base64" class="anchor"><span class="anchor-link"></span></a><code>$decode_base64</code></h4>
<p>This operator decodes a base64 string</p>
<p>expected configuration:</p>
<ul>
  <li><code>value</code> (<code>string</code>) - The base64 string to decode</li>
  <li>required fields are: <strong>value</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$decode_base64&quot; : {
    &quot;value&quot; : &quot;SGVsbG8sIFdvcmxkIQ==&quot;
  }
}
</code></pre>
<hr/>
<h4><a href="#subtract" name="subtract" class="anchor"><span class="anchor-link"></span></a><code>$subtract</code></h4>
<p>This operator subtracts a list of numbers</p>
<p>expected configuration:</p>
<ul>
  <li><code>values</code> (<code>array</code>) - The list of numbers to subtract</li>
  <li>required fields are: <strong>values</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$subtract&quot; : {
    &quot;values&quot; : [ 1, 2, 3 ]
  }
}
</code></pre>
<hr/>
<h4><a href="#json-parse" name="json-parse" class="anchor"><span class="anchor-link"></span></a><code>$json_parse</code></h4>
<p>This operator parses a JSON string</p>
<p>expected configuration:</p>
<ul>
  <li><code>value</code> (<code>string</code>) - The JSON string to parse</li>
  <li>required fields are: <strong>value</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$json_parse&quot; : {
    &quot;value&quot; : &quot;{}&quot;
  }
}
</code></pre>
<hr/>
<h4><a href="#contains" name="contains" class="anchor"><span class="anchor-link"></span></a><code>$contains</code></h4>
<p>This operator checks if a value is contained in a container</p>
<p>expected configuration:</p>
<ul>
  <li><code>value</code> (<code>any</code>) - The value to check</li>
  <li><code>container</code> (<code>any</code>) - The container to check</li>
  <li>required fields are: <strong>value</strong>, <strong>container</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$contains&quot; : {
    &quot;value&quot; : 1,
    &quot;container&quot; : [ 1, 2, 3 ]
  }
}
</code></pre>
<hr/>
<h4><a href="#gte" name="gte" class="anchor"><span class="anchor-link"></span></a><code>$gte</code></h4>
<p>This operator checks if a number is greater than or equal to another number</p>
<p>expected configuration:</p>
<ul>
  <li><code>a</code> (<code>number</code>) - The first number</li>
  <li><code>b</code> (<code>number</code>) - The second number</li>
  <li>required fields are: <strong>a</strong>, <strong>b</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$gte&quot; : {
    &quot;a&quot; : 1,
    &quot;b&quot; : 0
  }
}
</code></pre>
<hr/>
<h4><a href="#incr" name="incr" class="anchor"><span class="anchor-link"></span></a><code>$incr</code></h4>
<p>This operator increments a value by a given amount</p>
<p>expected configuration:</p>
<ul>
  <li><code>value</code> (<code>number</code>) - The value to increment</li>
  <li><code>increment</code> (<code>number</code>) - The amount to increment by</li>
  <li>required fields are: <strong>value</strong>, <strong>increment</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$incr&quot; : {
    &quot;value&quot; : 10,
    &quot;increment&quot; : 5
  }
}
</code></pre>
<hr/>
<h4><a href="#lt" name="lt" class="anchor"><span class="anchor-link"></span></a><code>$lt</code></h4>
<p>This operator checks if a number is less than another number</p>
<p>expected configuration:</p>
<ul>
  <li><code>a</code> (<code>number</code>) - The first number</li>
  <li><code>b</code> (<code>number</code>) - The second number</li>
  <li>required fields are: <strong>a</strong>, <strong>b</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$lt&quot; : {
    &quot;a&quot; : 1,
    &quot;b&quot; : 0
  }
}
</code></pre>
<hr/>
<h4><a href="#divide" name="divide" class="anchor"><span class="anchor-link"></span></a><code>$divide</code></h4>
<p>This operator divides a list of numbers</p>
<p>expected configuration:</p>
<ul>
  <li><code>values</code> (<code>array</code>) - The list of numbers to divide</li>
  <li>required fields are: <strong>values</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$divide&quot; : {
    &quot;values&quot; : [ 1, 2, 3 ]
  }
}
</code></pre>
<hr/>
<h4><a href="#map-put" name="map-put" class="anchor"><span class="anchor-link"></span></a><code>$map_put</code></h4>
<p>This operator puts a key-value pair in a map</p>
<p>expected configuration:</p>
<ul>
  <li><code>key</code> (<code>string</code>) - The key to put</li>
  <li><code>value</code> (<code>any</code>) - The value to put</li>
  <li><code>map</code> (<code>object</code>) - The map to put the key-value pair in</li>
  <li>required fields are: <strong>key</strong>, <strong>value</strong>, <strong>map</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$map_put&quot; : {
    &quot;key&quot; : &quot;my_key&quot;,
    &quot;value&quot; : &quot;my_value&quot;,
    &quot;map&quot; : {
      &quot;my_key&quot; : &quot;my_value&quot;
    }
  }
}
</code></pre>
<hr/>
<h4><a href="#multiply" name="multiply" class="anchor"><span class="anchor-link"></span></a><code>$multiply</code></h4>
<p>This operator multiplies a list of numbers</p>
<p>expected configuration:</p>
<ul>
  <li><code>values</code> (<code>array</code>) - The list of numbers to multiply</li>
  <li>required fields are: <strong>values</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$multiply&quot; : {
    &quot;values&quot; : [ 1, 2, 3 ]
  }
}
</code></pre>
<hr/>
<h4><a href="#str-concat" name="str-concat" class="anchor"><span class="anchor-link"></span></a><code>$str_concat</code></h4>
<p>This operator concatenates a list of strings</p>
<p>expected configuration:</p>
<ul>
  <li><code>values</code> (<code>array</code>) - The list of strings to concatenate</li>
  <li><code>separator</code> (<code>string</code>) - The separator to use</li>
  <li>required fields are: <strong>values</strong>, <strong>separator</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$str_concat&quot; : {
    &quot;values&quot; : [ &quot;Hello&quot;, &quot;World&quot; ],
    &quot;separator&quot; : &quot; &quot;
  }
}
</code></pre>
<hr/>
<h4><a href="#gt" name="gt" class="anchor"><span class="anchor-link"></span></a><code>$gt</code></h4>
<p>This operator checks if a number is greater than another number</p>
<p>expected configuration:</p>
<ul>
  <li><code>a</code> (<code>number</code>) - The first number</li>
  <li><code>b</code> (<code>number</code>) - The second number</li>
  <li>required fields are: <strong>a</strong>, <strong>b</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$gt&quot; : {
    &quot;a&quot; : 1,
    &quot;b&quot; : 0
  }
}
</code></pre>
<hr/>
<h4><a href="#str-upper-case" name="str-upper-case" class="anchor"><span class="anchor-link"></span></a><code>$str_upper_case</code></h4>
<p>This operator converts a string to uppercase</p>
<p>expected configuration:</p>
<ul>
  <li><code>value</code> (<code>string</code>) - The string to convert to uppercase</li>
  <li>required fields are: <strong>value</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$str_upper_case&quot; : {
    &quot;value&quot; : &quot;hello&quot;
  }
}
</code></pre>
<hr/>
<h4><a href="#is-truthy" name="is-truthy" class="anchor"><span class="anchor-link"></span></a><code>$is_truthy</code></h4>
<p>This operator checks if a value is truthy</p>
<p>expected configuration:</p>
<ul>
  <li><code>value</code> (<code>any</code>) - The value to check</li>
  <li>required fields are: <strong>value</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$is_truthy&quot; : {
    &quot;value&quot; : 1
  }
}
</code></pre>
<hr/>
<h4><a href="#map-del" name="map-del" class="anchor"><span class="anchor-link"></span></a><code>$map_del</code></h4>
<p>This operator deletes a key from a map</p>
<p>expected configuration:</p>
<ul>
  <li><code>key</code> (<code>string</code>) - The key to delete</li>
  <li><code>map</code> (<code>object</code>) - The map to delete the key from</li>
  <li>required fields are: <strong>key</strong>, <strong>map</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$map_del&quot; : {
    &quot;key&quot; : &quot;my_key&quot;,
    &quot;map&quot; : {
      &quot;my_key&quot; : &quot;my_value&quot;
    }
  }
}
</code></pre>
<hr/>
<h4><a href="#array-del" name="array-del" class="anchor"><span class="anchor-link"></span></a><code>$array_del</code></h4>
<p>This operator deletes an element from an array</p>
<p>expected configuration:</p>
<ul>
  <li><code>idx</code> (<code>integer</code>) - The index of the element to delete</li>
  <li><code>array</code> (<code>array</code>) - The array to delete the element from</li>
  <li>required fields are: <strong>idx</strong>, <strong>array</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$array_del&quot; : {
    &quot;idx&quot; : 0,
    &quot;array&quot; : [ &quot;my_value&quot; ]
  }
}
</code></pre>
<hr/>
<h4><a href="#decr" name="decr" class="anchor"><span class="anchor-link"></span></a><code>$decr</code></h4>
<p>This operator decrements a value by a given amount</p>
<p>expected configuration:</p>
<ul>
  <li><code>value</code> (<code>number</code>) - The value to decrement</li>
  <li><code>decrement</code> (<code>number</code>) - The amount to decrement by</li>
  <li>required fields are: <strong>value</strong>, <strong>decrement</strong></li>
</ul>
<p>Usage example</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;$decr&quot; : {
    &quot;value&quot; : 10,
    &quot;decrement&quot; : 5
  }
}
</code></pre>
<h2><a href="#plugins" name="plugins" class="anchor"><span class="anchor-link"></span></a>Plugins</h2>
<p>Workflows can be used inside routes using:</p>
<ul>
  <li><code>WorkflowBackend</code>: Use a workflow as backend handler</li>
  <li><code>WorkflowRequestTransformer</code> / <code>WorkflowResponseTransformer</code>: Mutate requests/responses</li>
  <li><code>WorkflowAccessValidator</code>: Validate access with workflow logic</li>
</ul>
<hr/>
<h2><a href="#examples" name="examples" class="anchor"><span class="anchor-link"></span></a>Examples</h2>
<h3><a href="#time-based-query-validator" name="time-based-query-validator" class="anchor"><span class="anchor-link"></span></a>Time-based Query Validator</h3>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot;: &quot;workflow&quot;,
  &quot;description&quot;: &quot;this workflow is supposed to be used in a WorkflowAccessValidator scenario where a request can pass if one of its query param if before a datetime&quot;,
  &quot;steps&quot;: [
    {
      &quot;description&quot;: &quot;extract date from request query params, and compute max possible datetime&quot;,
      &quot;kind&quot;: &quot;assign&quot;,
      &quot;values&quot;: [
        {
          &quot;name&quot;: &quot;query_date&quot;,
          &quot;value&quot;: {
            &quot;$parse_datetime&quot;: {
              &quot;value&quot;: &quot;${input.request.query.date.0}&quot;
            }
          }
        },
        {
          &quot;name&quot;: &quot;max_date&quot;,
          &quot;value&quot;: {
            &quot;$add&quot;: {
              &quot;values&quot;: [&quot;${now}&quot;, 7200000]
            }
          }
        }
      ]
    },
    {
      &quot;kind&quot;: &quot;if&quot;,
      &quot;description&quot;: &quot;check if extracted date is before max date&quot;,
      &quot;predicate&quot;: {
        &quot;$lte&quot;: {
          &quot;a&quot;: &quot;${query_date}&quot;,
          &quot;b&quot;: &quot;${max_date}&quot;
        }
      },
      &quot;then&quot;: {
        &quot;kind&quot;: &quot;assign&quot;,
        &quot;description&quot;: &quot;if so, let the call pass&quot;,
        &quot;values&quot;: [
          {
            &quot;name&quot;: &quot;call_res&quot;,
            &quot;value&quot;: {
              &quot;result&quot;: true,
              &quot;error&quot;: null
            }
          }
        ]
      },
      &quot;else&quot;: {
        &quot;kind&quot;: &quot;assign&quot;,
        &quot;description&quot;: &quot;if not, show error&quot;,  
        &quot;values&quot;: [
          {
            &quot;name&quot;: &quot;call_res&quot;,
            &quot;value&quot;: {
              &quot;result&quot;: false,
              &quot;error&quot;: {
                &quot;status&quot;: 400,
                &quot;message&quot;: &quot;Bad query param value&quot;
              }
            }
          }
        ]
      }
    }
  ],
  &quot;returned&quot;: {
    &quot;$mem_ref&quot;: {
      &quot;name&quot;: &quot;call_res&quot;
    }
  }
}
</code></pre>
<p>run at <code>2025-06-04T11:48:00.000</code> with input like:</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;request&quot;: {
    &quot;query&quot;: {
      &quot;date&quot;: [
        &quot;2025-06-04T11:00:00.000&quot;
      ]
    }
  }
}
</code></pre>
<p>the result:</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;returned&quot;: {
    &quot;result&quot;: true,
    &quot;error&quot;: null
  },
  &quot;error&quot;: null
}
</code></pre>
<p>the memory content: </p>
<pre class="prettyprint"><code class="language-json">{
  &quot;query_date&quot;: 1749027600000,
  &quot;call_res&quot;: {
    &quot;result&quot;: true,
    &quot;error&quot;: null
  },
  &quot;max_date&quot;: 1749037738115,
  &quot;input&quot;: {
    &quot;request&quot;: {
      &quot;query&quot;: {
        &quot;date&quot;: [
          &quot;2025-06-04T11:00:00.000&quot;
        ]
      }
    }
  }
}
</code></pre>
<p>run at <code>2025-06-04T11:48:00.000</code> with input like:</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;request&quot;: {
    &quot;query&quot;: {
      &quot;date&quot;: [
        &quot;2025-06-04T18:00:00.000&quot;
      ]
    }
  }
}
</code></pre>
<p>the result:</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;returned&quot;: {
    &quot;result&quot;: false,
    &quot;error&quot;: {
      &quot;status&quot;: 400,
      &quot;message&quot;: &quot;Bad query param value&quot;
    }
  },
  &quot;error&quot;: null
}
</code></pre>
<p>the memory content: </p>
<pre class="prettyprint"><code class="language-json">{
  &quot;query_date&quot;: 1749052800000,
  &quot;call_res&quot;: {
    &quot;result&quot;: false,
    &quot;error&quot;: {
      &quot;status&quot;: 400,
      &quot;message&quot;: &quot;Bad query param value&quot;
    }
  },
  &quot;max_date&quot;: 1749037844696,
  &quot;input&quot;: {
    &quot;request&quot;: {
      &quot;query&quot;: {
        &quot;date&quot;: [
          &quot;2025-06-04T18:00:00.000&quot;
        ]
      }
    }
  }
}
</code></pre>
<h3><a href="#api-consumer-transformer" name="api-consumer-transformer" class="anchor"><span class="anchor-link"></span></a>API Consumer &amp; Transformer</h3>
<pre class="prettyprint"><code class="language-json">{
  &quot;kind&quot;: &quot;workflow&quot;,
  &quot;steps&quot;: [
    {
      &quot;kind&quot;: &quot;call&quot;,
      &quot;description&quot;: &quot;get all pokemons from the pokeapi&quot;,
      &quot;function&quot;: &quot;core.http_client&quot;,
      &quot;args&quot;: {
        &quot;method&quot;: &quot;GET&quot;,
        &quot;url&quot;: &quot;https://pokeapi.co/api/v2/pokemon&quot;
      },
      &quot;result&quot;: &quot;pokemons&quot;
    },
    {
      &quot;kind&quot;: &quot;assign&quot;,
      &quot;description&quot;: &quot;extract results from the response, and only keep the 5 first pokemons&quot;,
      &quot;values&quot;: [
        {
          &quot;name&quot;: &quot;pokemons&quot;,
          &quot;value&quot;: {
            &quot;$array_page&quot;: {
              &quot;array&quot;: &quot;${pokemons.body_json.results}&quot;,
              &quot;page&quot;: 1,
              &quot;page_size&quot;: 5
            }
          }
        },
        {
          &quot;name&quot;: &quot;pokemon_names&quot;,
          &quot;value&quot;: []
        }
      ]
    },
    {
      &quot;kind&quot;: &quot;map&quot;,
      &quot;description&quot;: &quot;for each pokemon, just extract its name&quot;,
      &quot;values&quot;: &quot;${pokemons}&quot;,
      &quot;node&quot;: {
        &quot;kind&quot;: &quot;value&quot;,
        &quot;value&quot;: &quot;${foreach_value.name}&quot;
      },
      &quot;result&quot;: &quot;pokemon_names&quot;
    }
  ],
  &quot;returned&quot;: {
    &quot;$mem_ref&quot;: {
      &quot;name&quot;: &quot;pokemon_names&quot;
    }
  }
}
</code></pre>
<p>the result:</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;returned&quot;: [
    &quot;charizard&quot;,
    &quot;squirtle&quot;,
    &quot;wartortle&quot;,
    &quot;blastoise&quot;,
    &quot;caterpie&quot;
  ],
  &quot;error&quot;: null
}
</code></pre>
<p>the memory content:</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;pokemons&quot;: [
    {
      &quot;name&quot;: &quot;charizard&quot;,
      &quot;url&quot;: &quot;https://pokeapi.co/api/v2/pokemon/6/&quot;
    },
    {
      &quot;name&quot;: &quot;squirtle&quot;,
      &quot;url&quot;: &quot;https://pokeapi.co/api/v2/pokemon/7/&quot;
    },
    {
      &quot;name&quot;: &quot;wartortle&quot;,
      &quot;url&quot;: &quot;https://pokeapi.co/api/v2/pokemon/8/&quot;
    },
    {
      &quot;name&quot;: &quot;blastoise&quot;,
      &quot;url&quot;: &quot;https://pokeapi.co/api/v2/pokemon/9/&quot;
    },
    {
      &quot;name&quot;: &quot;caterpie&quot;,
      &quot;url&quot;: &quot;https://pokeapi.co/api/v2/pokemon/10/&quot;
    }
  ],
  &quot;pokemon_names&quot;: [
    &quot;charizard&quot;,
    &quot;squirtle&quot;,
    &quot;wartortle&quot;,
    &quot;blastoise&quot;,
    &quot;caterpie&quot;
  ],
  &quot;input&quot;: {}
}
</code></pre>
<h3><a href="#ai-agent" name="ai-agent" class="anchor"><span class="anchor-link"></span></a>AI Agent</h3>
<p>An AI agent with persistent memory, tools and that can support audio as input and output, using the <a href="https://cloud-apim.github.io/otoroshi-llm-extension/">Cloud API Otoroshi LLM Extension</a>. This workflow can be used from a <code>WorkflowBackend</code> plugin.</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;id&quot;: &quot;main&quot;,
  &quot;kind&quot;: &quot;workflow&quot;,
  &quot;steps&quot;: [
    {
      &quot;description&quot;: &quot;check if input is audio or text&quot;,
      &quot;kind&quot;: &quot;if&quot;,
      &quot;predicate&quot;: {
        &quot;$is_truthy&quot;: {
          &quot;value&quot;: &quot;${input.request.body_json.audio}&quot;
        }
      },
      &quot;then&quot;: {
        &quot;description&quot;: &quot;if audio, transform to text&quot;,
        &quot;kind&quot;: &quot;call&quot;,
        &quot;function&quot;: &quot;extensions.com.cloud-apim.llm-extension.audio_stt&quot;,
        &quot;args&quot;: {
          &quot;provider&quot;: &quot;audio-model_openai&quot;,
          &quot;decode_base64&quot;: true,
          &quot;payload&quot;: {
            &quot;model&quot;: &quot;gpt-4o-mini-transcribe&quot;,
            &quot;audio&quot;: &quot;${input.request.body_json.audio}&quot;
          }
        },
        &quot;result&quot;: &quot;input_text&quot;
      },
      &quot;else&quot;: {
        &quot;description&quot;: &quot;if not audio, just assign in memory&quot;,
        &quot;kind&quot;: &quot;assign&quot;,
        &quot;values&quot;: [
          {
            &quot;name&quot;: &quot;input_text&quot;,
            &quot;value&quot;: &quot;${input.request.body_json.text}&quot;
          }
        ]
      }
    },
    {
      &quot;description&quot;: &quot;call the first llm with all the context, memory and tool needed like websearch, URL wrawling, etc to get a first raw response&quot;,
      &quot;kind&quot;: &quot;call&quot;,
      &quot;function&quot;: &quot;extensions.com.cloud-apim.llm-extension.llm_call&quot;,
      &quot;args&quot;: {
        &quot;provider&quot;: &quot;provider_openai&quot;,
        &quot;openai_format&quot;: false,
        &quot;memory&quot;: &quot;persistent-memory_local&quot;,
        &quot;tool_functions&quot;: [
          &quot;tool-function_site2md&quot;,
          &quot;tool-function_websearch&quot;
        ],
        &quot;payload&quot;: {
          &quot;model&quot;: &quot;gpt-4o&quot;,
          &quot;max_tokens&quot;: 3000,
          &quot;messages&quot;: [
            {
              &quot;role&quot;: &quot;system&quot;,
              &quot;content&quot;: &quot;You are a smart, reliable, organized, and proactive personal assistant. You assist a user named Foo, an experienced software engineer, in managing his daily tasks, technical projects, creative ideas, as well as personal and family needs.\\n\\nYou are able to:\\n\\nOrganize ideas, projects, tasks, reminders, and priorities.\\n\\nProvide technical advice (backend, frontend, DevOps, AI, APIs, cybersecurity…).\\n\\nSuggest solutions or tools to save time.\\n\\nRespond with empathy, clarity, and efficiency.\\n\\nGenerate useful content (emails, scripts, messages, ideas, to-do lists…).\\n\\nMaintain a professional yet human tone, with a touch of light humor or camaraderie when appropriate.\\n\\nYour answers should be:\\n\\nConcise when brevity is requested.\\n\\nDetailed and structured when needed.\\n\\nAction-oriented, with concrete suggestions.\\n\\nYou may ask Foo questions to clarify his requests or anticipate his needs. You are available at all times, but never intrusive. Today’s date is ${now_str}.&quot;
            },
            {
              &quot;role&quot;: &quot;user&quot;,
              &quot;content&quot;: &quot;${input_text}&quot;
            }
          ]
        }
      },
      &quot;result&quot;: &quot;agent-1&quot;
    },
    {
      &quot;description&quot;: &quot;extract the text response from the LLM API response&quot;,
      &quot;kind&quot;: &quot;assign&quot;,
      &quot;values&quot;: [
        {
          &quot;name&quot;: &quot;agent-1&quot;,
          &quot;value&quot;: {
            &quot;$mem_ref&quot;: {
              &quot;name&quot;: &quot;agent-1&quot;,
              &quot;path&quot;: &quot;generations.0.message.content&quot;
            }
          }
        }
      ]
    },
    {
      &quot;description&quot;: &quot;now, ask a second LLM model to rewrite the raw response with an agent personnality&quot;,
      &quot;kind&quot;: &quot;call&quot;,
      &quot;function&quot;: &quot;extensions.com.cloud-apim.llm-extension.llm_call&quot;,
      &quot;args&quot;: {
        &quot;provider&quot;: &quot;provider_openai&quot;,
        &quot;openai_format&quot;: false,
        &quot;payload&quot;: {
          &quot;model&quot;: &quot;gpt-4o-mini&quot;,
          &quot;max_tokens&quot;: 500,
          &quot;messages&quot;: [
            {
              &quot;role&quot;: &quot;system&quot;,
              &quot;content&quot;: &quot;You are Jarvis, the personal AI assistant of Mister Foo. You embody an exceptional English butler — impeccably professional, unflappably composed, and sharply intelligent. Your tone is calm, polite, elegant, often subtly ironic, and always remarkably precise.\\n\\nYour task is to take the raw response from a primary AI assistant and:\\n\\nSummarize or rephrase it clearly and concisely, in the briefest form possible.\\n\\nExpress it in a tone worthy of an English butler, inspired by Jarvis from Iron Man.\\n\\nSubtly add refined touches of irony or wit where appropriate.\\n\\nFormat the response so that it is readable, pleasant, and effective.\\n\\nYou do not answer the user&#39;s original question directly: you narrate and synthesize what the other assistant said — but with flair. Do not mention the previous assistant; the response must appear to come from you.\\n\\nFor example, if the raw AI gives a long technical explanation, you may conclude your summary with:\\n\&quot;In short, Sir, should you embark on this path, I suggest preparing some tea and a comfortable chair.\&quot;\\n\\nA few stylistic rules:\\n\\nNever be casual or coarse.\\n\\nAlways prioritize elegance of expression.\\n\\nNever invent technical content — only reformulate what was given to you.\\n\\nIf the original response is too long, condense it into one or two essential points. But do not number them (1., 2.); instead, connect the ideas naturally as a proper English butler would.\\n\\nIn all circumstances, you are precise, loyal, discreet.&quot;
            },
            {
              &quot;role&quot;: &quot;user&quot;,
              &quot;content&quot;: &quot;${agent-1}&quot;
            }
          ]
        }
      },
      &quot;result&quot;: &quot;jarvis&quot;
    },
    {
      &quot;description&quot;: &quot;extract the text response from the LLM API response&quot;,
      &quot;kind&quot;: &quot;assign&quot;,
      &quot;values&quot;: [
        {
          &quot;name&quot;: &quot;jarvis&quot;,
          &quot;value&quot;: {
            &quot;$mem_ref&quot;: {
              &quot;name&quot;: &quot;jarvis&quot;,
              &quot;path&quot;: &quot;generations.0.message.content&quot;
            }
          }
        }
      ]
    },
    {
      &quot;description&quot;: &quot;transform jarvis response to audio&quot;,
      &quot;kind&quot;: &quot;call&quot;,
      &quot;function&quot;: &quot;extensions.com.cloud-apim.llm-extension.audio_tts&quot;,
      &quot;args&quot;: {
        &quot;provider&quot;: &quot;audio-model_openai&quot;,
        &quot;payload&quot;: {
          &quot;input&quot;: &quot;${jarvis}&quot;,
          &quot;voice&quot;: &quot;echo&quot;,
          &quot;instructions&quot;: &quot;parle comme un majordome anglais zélé et flegmatique&quot;,
          &quot;model&quot;: &quot;gpt-4o-mini-tts&quot;,
          &quot;speed&quot;: 1.2
        },
        &quot;encode_base64&quot;: true
      },
      &quot;result&quot;: &quot;audio_base64&quot;
    },
    {
      &quot;description&quot;: &quot;write the audio as file, used for local debug only&quot;,
      &quot;kind&quot;: &quot;call&quot;,
      &quot;function&quot;: &quot;core.file_write&quot;,
      &quot;enabled&quot;: false,
      &quot;args&quot;: {
        &quot;value&quot;: &quot;${audio_base64.base64}&quot;,
        &quot;from_base64&quot;: true
      },
      &quot;result&quot;: &quot;audio_file&quot;
    },
    {
      &quot;description&quot;: &quot;create the http respond that will be send back to the consumer, containing the audio file base64 encoded&quot;,
      &quot;kind&quot;: &quot;assign&quot;,
      &quot;values&quot;: [
        {
          &quot;name&quot;: &quot;call_res&quot;,
          &quot;value&quot;: {
            &quot;status&quot;: 200,
            &quot;headers&quot;: {
              &quot;Content-Type&quot;: &quot;application/json&quot;
            },
            &quot;body_json&quot;: {
              &quot;text&quot;: &quot;${jarvis}&quot;,
              &quot;audio_base64&quot;: &quot;${audio_base64}&quot;
            }
          }
        }
      ]
    },
    {
      &quot;description&quot;: &quot;play the audio file using VLC, used for local debug only&quot;,
      &quot;kind&quot;: &quot;call&quot;,
      &quot;function&quot;: &quot;core.system_call&quot;,
      &quot;enabled&quot;: false,
      &quot;args&quot;: {
        &quot;command&quot;: [
          &quot;open&quot;,
          &quot;-a&quot;,
          &quot;VLC&quot;,
          &quot;${audio_file.file_path}&quot;
        ]
      },
      &quot;result&quot;: &quot;play&quot;
    }
  ],
  &quot;returned&quot;: {
    &quot;$mem_ref&quot;: {
      &quot;name&quot;: &quot;call_res&quot;
    }
  }
}
</code></pre>
<p>with the associated resources to make it work: </p>
<pre class="prettyprint"><code class="language-json">{
  &quot;_loc&quot;: {
    &quot;tenant&quot;: &quot;default&quot;,
    &quot;teams&quot;: [
      &quot;default&quot;
    ]
  },
  &quot;id&quot;: &quot;tool-function_websearch&quot;,
  &quot;name&quot;: &quot;websearch&quot;,
  &quot;description&quot;: &quot;This function can be used to search the web on whatever topic you need. Like \&quot;what new today ?\&quot; or \&quot;can you make some research about xxx\&quot; etc&quot;,
  &quot;metadata&quot;: {},
  &quot;tags&quot;: [],
  &quot;strict&quot;: true,
  &quot;parameters&quot;: {
    &quot;query&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;The search query&quot;
    }
  },
  &quot;required&quot;: null,
  &quot;backend&quot;: {
    &quot;kind&quot;: &quot;Http&quot;,
    &quot;options&quot;: {
      &quot;url&quot;: &quot;https://api.openai.com/v1/responses&quot;,
      &quot;method&quot;: &quot;POST&quot;,
      &quot;body&quot;: &quot;{\n  \&quot;model\&quot;: \&quot;gpt-4.1\&quot;,\n  \&quot;tools\&quot;: [{\&quot;type\&quot;: \&quot;web_search_preview\&quot;}],\n  \&quot;input\&quot;: \&quot;${query}\&quot;\n}&quot;,
      &quot;headers&quot;: {
        &quot;Content-Type&quot;: &quot;application/json&quot;,
        &quot;Authorization&quot;: &quot;Bearer ${vault://local/openai-token}&quot;
      },
      &quot;response_at&quot;: &quot;output.1.content.0.text&quot;
    }
  },
  &quot;kind&quot;: &quot;ai-gateway.extensions.cloud-apim.com/ToolFunction&quot;
}
</code></pre>
<pre class="prettyprint"><code class="language-json">{
  &quot;_loc&quot;: {
    &quot;tenant&quot;: &quot;default&quot;,
    &quot;teams&quot;: [
      &quot;default&quot;
    ]
  },
  &quot;id&quot;: &quot;tool-function_site2md&quot;,
  &quot;name&quot;: &quot;site2md&quot;,
  &quot;description&quot;: &quot;This function can be used to fetch the content of an url, a webpage. The content of the page will be returned as markdown for better llm readability. It can be used to summarize the content of a page like \&quot;hey, tell me what&#39;s on https://site2md.com/\&quot;&quot;,
  &quot;metadata&quot;: {},
  &quot;tags&quot;: [],
  &quot;strict&quot;: true,
  &quot;parameters&quot;: {
    &quot;user_url&quot;: {
      &quot;type&quot;: &quot;string&quot;,
      &quot;description&quot;: &quot;The URL of the webpage to fetch&quot;
    }
  },
  &quot;required&quot;: null,
  &quot;backend&quot;: {
    &quot;kind&quot;: &quot;Http&quot;,
    &quot;options&quot;: {
      &quot;method&quot;: &quot;GET&quot;,
      &quot;url&quot;: &quot;https://site2md.com/${user_url}&quot;
    }
  },
  &quot;kind&quot;: &quot;ai-gateway.extensions.cloud-apim.com/ToolFunction&quot;
}
</code></pre>
<pre class="prettyprint"><code class="language-json">{
  &quot;_loc&quot;: {
    &quot;tenant&quot;: &quot;default&quot;,
    &quot;teams&quot;: [
      &quot;default&quot;
    ]
  },
  &quot;id&quot;: &quot;audio-model_openai&quot;,
  &quot;name&quot;: &quot;Audio model&quot;,
  &quot;description&quot;: &quot;An audio model&quot;,
  &quot;metadata&quot;: {},
  &quot;tags&quot;: [],
  &quot;provider&quot;: &quot;openai&quot;,
  &quot;config&quot;: {
    &quot;connection&quot;: {
      &quot;token&quot;: &quot;${vault://local/openai-token}&quot;,
      &quot;timeout&quot;: 30000
    },
    &quot;options&quot;: {
      &quot;tts&quot;: {
        &quot;model&quot;: &quot;gpt-4o-mini-tts&quot;,
        &quot;response_format&quot;: &quot;mp3&quot;,
        &quot;speed&quot;: 1
      },
      &quot;stt&quot;: {
        &quot;model&quot;: &quot;gpt-4o-mini-transcribe&quot;
      }
    }
  },
  &quot;kind&quot;: &quot;ai-gateway.extensions.cloud-apim.com/AudioModel&quot;
}
</code></pre>
<pre class="prettyprint"><code class="language-json">{
  &quot;_loc&quot;: {
    &quot;tenant&quot;: &quot;default&quot;,
    &quot;teams&quot;: [
      &quot;default&quot;
    ]
  },
  &quot;id&quot;: &quot;provider_openai&quot;,
  &quot;name&quot;: &quot;OpenAI clean&quot;,
  &quot;description&quot;: &quot;An OpenAI LLM api provider&quot;,
  &quot;metadata&quot;: {},
  &quot;tags&quot;: [],
  &quot;provider&quot;: &quot;openai&quot;,
  &quot;connection&quot;: {
    &quot;base_url&quot;: &quot;https://api.openai.com/v1&quot;,
    &quot;token&quot;: &quot;${vault://local/openai-token}&quot;,
    &quot;timeout&quot;: 30000
  },
  &quot;options&quot;: {
    &quot;model&quot;: &quot;gpt-4o-mini&quot;,
    &quot;frequency_penalty&quot;: null,
    &quot;logit_bias&quot;: null,
    &quot;logprobs&quot;: null,
    &quot;top_logprobs&quot;: null,
    &quot;max_tokens&quot;: null,
    &quot;n&quot;: 1,
    &quot;presence_penalty&quot;: null,
    &quot;response_format&quot;: null,
    &quot;seed&quot;: null,
    &quot;stop&quot;: null,
    &quot;stream&quot;: false,
    &quot;temperature&quot;: 1,
    &quot;top_p&quot;: 1,
    &quot;tools&quot;: null,
    &quot;tool_choice&quot;: null,
    &quot;user&quot;: null,
    &quot;wasm_tools&quot;: [],
    &quot;mcp_connectors&quot;: [],
    &quot;allow_config_override&quot;: true
  },
  &quot;provider_fallback&quot;: null,
  &quot;memory&quot;: &quot;null&quot;,
  &quot;context&quot;: {
    &quot;default&quot;: null,
    &quot;contexts&quot;: []
  },
  &quot;models&quot;: {
    &quot;include&quot;: [],
    &quot;exclude&quot;: []
  },
  &quot;guardrails&quot;: [],
  &quot;guardrails_fail_on_deny&quot;: false,
  &quot;cache&quot;: {
    &quot;strategy&quot;: &quot;none&quot;,
    &quot;ttl&quot;: 300000,
    &quot;score&quot;: 0.8
  },
  &quot;kind&quot;: &quot;ai-gateway.extensions.cloud-apim.com/Provider&quot;
}
</code></pre>
<pre class="prettyprint"><code class="language-json">{
  &quot;_loc&quot;: {
    &quot;tenant&quot;: &quot;default&quot;,
    &quot;teams&quot;: [
      &quot;default&quot;
    ]
  },
  &quot;id&quot;: &quot;persistent-memory_local&quot;,
  &quot;name&quot;: &quot;Local persistent memory&quot;,
  &quot;description&quot;: &quot;A local persistent memory&quot;,
  &quot;metadata&quot;: {},
  &quot;tags&quot;: [],
  &quot;provider&quot;: &quot;local&quot;,
  &quot;config&quot;: {
    &quot;options&quot;: {
      &quot;session_id&quot;: &quot;${consumer.id || apikey.id || user.email || token.sub || req.ip :: default}&quot;,
      &quot;strategy&quot;: &quot;message_window&quot;,
      &quot;max_messages&quot;: 100
    }
  },
  &quot;kind&quot;: &quot;ai-gateway.extensions.cloud-apim.com/PersistentMemory&quot;
}
</code></pre>
<p>when run with input like:</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;request&quot;: {
    &quot;body_json&quot;: {
      &quot;text&quot;: &quot;hey jarvis, what are the news today ?&quot;
    }
  }
}
</code></pre>
<p>the result is:</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;returned&quot;: {
    &quot;status&quot;: 200,
    &quot;headers&quot;: {
      &quot;Content-Type&quot;: &quot;application/json&quot;
    },
    &quot;body_json&quot;: {
      &quot;text&quot;: &quot;Ah, dear Sir, allow me to present you with a concise overview of the most noteworthy events of the day, as of June 4th, 2025.\n\nOn the international stage, Poland has elected a new president — the conservative Karol Nawrocki — following a tightly contested vote, while in South Korea, opposition leader Lee Jae-myung secured victory in the June 3rd presidential elections.\n\nIn the United States, President Donald Trump is making headlines once again, this time with a series of executive orders, including a controversial revision of diversity and inclusion policies. *The Daily Show* has, of course, offered its trademark satirical take on the developments.\n\nAs for the weather in New York, skies are a brilliant blue, with temperatures ranging from a mild 63°F (17°C) this morning to a predicted high of 82°F (28°C) later today.\n\nOn the financial front, the markets are showing modest gains — the SPDR S&amp;P 500 is slightly up, along with the Dow Jones and the QQQ.\n\nAnd finally, for those with a taste for rock, the band Volbeat is set to release its new album *God of Angels Trust* on June 6th, followed by the eagerly awaited Oasis reunion tour, kicking off on July 4th in Cardiff.\n\nShould you wish to delve deeper into any of these topics, I remain entirely at your disposal, of course.&quot;,
      &quot;audio_base64&quot;: {
        &quot;content_type&quot;: &quot;audio/mpeg&quot;,
        &quot;base64&quot;: &quot;...&quot;
      }
    }
  },
  &quot;error&quot;: null
}
</code></pre>
<p>the memory content is:</p>
<pre class="prettyprint"><code class="language-json">{
  &quot;call_res&quot;: {
    &quot;status&quot;: 200,
    &quot;headers&quot;: {
      &quot;Content-Type&quot;: &quot;application/json&quot;
    },
    &quot;body_json&quot;: {
      &quot;text&quot;: &quot;Ah, dear Sir, allow me to present you with a concise overview of the most noteworthy events of the day, as of June 4th, 2025.\n\nOn the international stage, Poland has elected a new president — the conservative Karol Nawrocki — following a tightly contested vote, while in South Korea, opposition leader Lee Jae-myung secured victory in the June 3rd presidential elections.\n\nIn the United States, President Donald Trump is making headlines once again, this time with a series of executive orders, including a controversial revision of diversity and inclusion policies. *The Daily Show* has, of course, offered its trademark satirical take on the developments.\n\nAs for the weather in New York, skies are a brilliant blue, with temperatures ranging from a mild 63°F (17°C) this morning to a predicted high of 82°F (28°C) later today.\n\nOn the financial front, the markets are showing modest gains — the SPDR S&amp;P 500 is slightly up, along with the Dow Jones and the QQQ.\n\nAnd finally, for those with a taste for rock, the band Volbeat is set to release its new album *God of Angels Trust* on June 6th, followed by the eagerly awaited Oasis reunion tour, kicking off on July 4th in Cardiff.\n\nShould you wish to delve deeper into any of these topics, I remain entirely at your disposal, of course.&quot;,
      &quot;audio_base64&quot;: {
        &quot;content_type&quot;: &quot;audio/mpeg&quot;,
        &quot;base_64&quot;: &quot;...&quot;
      }
    }
  },
  &quot;play&quot;: {
    &quot;stdout&quot;: &quot;&quot;,
    &quot;stderr&quot;: &quot;&quot;,
    &quot;code&quot;: 0
  },
  &quot;jarvis&quot;: &quot;Ah, dear Sir, allow me to present you with a concise overview of the most noteworthy events of the day, as of June 4th, 2025.\n\nOn the international stage, Poland has elected a new president — the conservative Karol Nawrocki — following a tightly contested vote, while in South Korea, opposition leader Lee Jae-myung secured victory in the June 3rd presidential elections.\n\nIn the United States, President Donald Trump is making headlines once again, this time with a series of executive orders, including a controversial revision of diversity and inclusion policies. *The Daily Show* has, of course, offered its trademark satirical take on the developments.\n\nAs for the weather in New York, skies are a brilliant blue, with temperatures ranging from a mild 63°F (17°C) this morning to a predicted high of 82°F (28°C) later today.\n\nOn the financial front, the markets are showing modest gains — the SPDR S&amp;P 500 is slightly up, along with the Dow Jones and the QQQ.\n\nAnd finally, for those with a taste for rock, the band Volbeat is set to release its new album *God of Angels Trust* on June 6th, followed by the eagerly awaited Oasis reunion tour, kicking off on July 4th in Cardiff.\n\nShould you wish to delve deeper into any of these topics, I remain entirely at your disposal, of course.&quot;,
  &quot;agent-1&quot;: &quot;Here are the latest news updates for today, June 4, 2025:\n\n### International News\n- **Poland Elects New President**: Karol Nawrocki, a conservative historian, recently won the Polish presidential election in a narrow victory.\n- **South Korea&#39;s Presidential Election**: The opposition candidate, Lee Jae-myung, secured a decisive win in South Korea&#39;s presidential election on June 3.\n\n### United States News\n- **Political Developments**: President Donald Trump is making headlines with a series of executive orders, including the rollback of government diversity, equity, and inclusion (DEI) and affirmative action rules.\n- **Media and Entertainment**: \&quot;The Daily Show\&quot; continues to cover current events, focusing on President Trump&#39;s recent actions.\n\n### Weather Update for New York, NY\n- **Current Conditions**: Mostly sunny, 63°F (17°C).\n- **Hourly Forecast**:\n  - 12:00 PM: 78°F (26°C)\n  - 1:00 PM: 80°F (26°C)\n  - 2:00 PM: 82°F (28°C)\n\n### Financial Markets\n- **SPDR S&amp;P 500 ETF Trust (SPY)**: Trading at $596.09, up $3.37 (0.57%).\n- **SPDR Dow Jones Industrial Average ETF (DIA)**: Trading at $426.01, up $2.22 (0.52%).\n- **Invesco QQQ Trust Series 1 (QQQ)**: Trading at $527.30, up $4.14 (0.79%).\n\n### Upcoming Events\n- **Volbeat&#39;s Album Release**: Their ninth studio album, \&quot;God of Angels Trust,\&quot; is set to be released on June 6, 2025.\n- **Oasis Reunion Tour**: The band&#39;s reunion tour, \&quot;Oasis Live &#39;25,\&quot; will kick off on July 4 in Cardiff, UK.\n\nFor more details, feel free to ask!&quot;,
  &quot;input_text&quot;: &quot;hey jarvis, what are the news today ?&quot;,
  &quot;audio_base64&quot;: {
    &quot;content_type&quot;: &quot;audio/mpeg&quot;,
    &quot;base_64&quot;: &quot;...&quot;
  },
  &quot;audio_file&quot;: {
    &quot;file_path&quot;: &quot;/var/folders/b4/_vkrx8n14qq2hx2y4hwln09w0000gn/T/llm-ext-fw-6827936985828753129.tmp&quot;
  },
  &quot;input&quot;: {
    &quot;request&quot;: {
      &quot;body_json&quot;: {
        &quot;text&quot;: &quot;hey jarvis, what are the news today ?&quot;
      }
    }
  }
}
</code></pre>
<h2><a href="#next-steps" name="next-steps" class="anchor"><span class="anchor-link"></span></a>Next Steps</h2>
<p>Workflows in Otoroshi open the door to advanced runtime logic inside your API Gateway. You can build integrations, automations, validators, orchestrations, and more — all in pure JSON.</p>
<p>For production-grade scenarios, consider:</p>
<ul>
  <li>Building and testing reusable workflows</li>
  <li>Adding your own functions/operators</li>
  <li>Securing workflows with access rights and guards</li>
</ul>
<p>You can even go as far as using workflows to implement AI agents, task runners, or content pipelines.</p>
<div class="nav-next">
<p><strong>Next:</strong> <a href="../how-to-s/index.html">How to&rsquo;s</a></p>
</div>
</div>
<div class="large-3 show-for-large column" data-sticky-container>
<nav class="sidebar sticky" data-sticky data-anchor="docs" data-sticky-on="large">
<div class="page-nav">
<div class="nav-title">
<h3>On this page</h3>
</div>
<div class="nav-toc">
<ul>
  <li><a href="../topics/workflows.html#otoroshi-workflows" class="header">Otoroshi Workflows</a>
  <ul>
    <li><a href="../topics/workflows.html#key-concepts" class="header">Key Concepts</a></li>
    <li><a href="../topics/workflows.html#basic-example" class="header">Basic Example</a></li>
    <li><a href="../topics/workflows.html#memory" class="header">Memory</a></li>
    <li><a href="../topics/workflows.html#nodes" class="header">Nodes</a></li>
    <li><a href="../topics/workflows.html#functions" class="header">Functions</a></li>
    <li><a href="../topics/workflows.html#operators" class="header">Operators</a></li>
    <li><a href="../topics/workflows.html#plugins" class="header">Plugins</a></li>
    <li><a href="../topics/workflows.html#examples" class="header">Examples</a></li>
    <li><a href="../topics/workflows.html#next-steps" class="header">Next Steps</a></li>
  </ul></li>
</ul>
</div>
</div>
</nav>
</div>
</div>

</section>
</div>

</div>

<footer class="site-footer">

<section class="site-footer-nav">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 medium-4 large-3 text-center column">
<div class="nav-links">
<ul>
<!-- <li><a href="https://www.example.com/products/">Products</a> -->
</ul>
</div>
</div>

</div>
</div>
</div>
</section>

<section class="site-footer-base">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 text-center large-9 column">

<!--
<div class="copyright">
<span class="text">&copy; 2025</span>
<a href="https://www.example.com" class="logo">logo</a>
</div>
-->
</div>

</div>
</div>
</div>
</section>
</footer>

</div>
</div>
</div>
</body>

<script type="text/javascript" src="../lib/foundation/dist/foundation.min.js"></script>
<script type="text/javascript">jQuery(document).foundation();</script>
<script type="text/javascript" src="../js/magellan.js"></script>

<style type="text/css">@import "../lib/prettify/prettify.css";</style>
<script type="text/javascript" src="../lib/prettify/prettify.js"></script>
<script type="text/javascript" src="../lib/prettify/lang-scala.js"></script>
<script type="text/javascript">jQuery(function(){window.prettyPrint && prettyPrint()});</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/elasticlunr/0.9.5/elasticlunr.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-112498312-1"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'UA-112498312-1');
</script>
</html>




